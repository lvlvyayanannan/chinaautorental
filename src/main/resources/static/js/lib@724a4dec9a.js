/*! Copyright@2008-2017 zuche.com All Rights Reserved.2019-07-17 */
define("",[],function(require,exports,module){require("public/lib/jquery/jquery.hoverdelay"),require("public/lib/jquery/jquery-calendar"),require("public/lib/jquery/jquery.slide-sz"),require("public/lib/jquery/jquery.cityport"),require("public/lib/jquery/jquery.deptport")}),define("public/lib/jquery/jquery.hoverdelay",[],function(require,exports,module){!function($){$.fn.hoverDelay=function(options){var hoverTimer,outTimer,defaults={hoverDuring:200,outDuring:200,hoverEvent:function(){$.noop()},outEvent:function(){$.noop()}},sets=$.extend(defaults,options||{}),that=this;return $(this).each(function(){$(this).hover(function(){clearTimeout(outTimer),hoverTimer=setTimeout(function(){sets.hoverEvent.apply(that)},sets.hoverDuring)},function(){clearTimeout(hoverTimer),outTimer=setTimeout(function(){sets.outEvent.apply(that)},sets.outDuring)})})}}(jQuery)}),define("public/lib/jquery/jquery-calendar",[],function(require,exports,module){!function($){$.fn.extend({calendar:function(_setting){var $calendarEle=$(this),now=new Date,l=null,uid="calendar_"+(new Date).getTime()+Math.floor(1e3*Math.random()+1),common_utils={_cache_:{},VERSION:"1.0.2",DKEY:"yyyy-mm",MASK:"yyyy-mm-dd",log:function(msg){if(common_utils._cache_.logs||(common_utils._cache_.logs=[]),!msg)return common_utils._cache_.logs;common_utils._cache_.logs.push(msg)},pad:function(num,len){for(num+="",len=len||2;num.length<len;)num="0"+num;return num},format:function(dateTime,pattern){pattern=pattern||this.MASK;var date=dateTime.getDate(),month=dateTime.getMonth(),year=dateTime.getFullYear(),hour=dateTime.getHours(),minutes=dateTime.getMinutes(),seconds=dateTime.getSeconds(),time=dateTime.getTime(),p={d:date,dd:common_utils.pad(date),m:month+1,mm:common_utils.pad(month+1),yy:String(year).slice(2),yyyy:year,H:hour,M:minutes,S:seconds,L:common_utils.pad(time,3)};return pattern.replace(/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|"[^"]*"|'[^']*'/g,function(flag){return flag in p?p[flag]:flag.slice(1,flag.length-1)})},parseDateInt:function(date){return"string"==typeof date&&(date=date.toDate()),!!date&&parseInt(common_utils.format(date,"yyyymmdd"),10)},addMonth:function(date,value){return new Date(date.getFullYear(),date.getMonth()+value,1)},get:function(date,firstWeek){if(!date)return common_utils.log("Date is null, Can't create calendar data structure."),null;var simple_date=common_utils.format(date,"yyyy-mm");return common_utils._cache_[simple_date]||common_utils.create(date,simple_date,firstWeek),common_utils._cache_[simple_date]},create:function(date,flag,firstWeek){firstWeek>6&&(firstWeek=1);for(var year=date.getFullYear(),month=date.getMonth(),week=new Date(year,month,firstWeek).getDay()-1,g=[],l=0;42>l;l++){var tempDate=new Date(year,month,l-week),simpleDate=common_utils.format(tempDate,"yyyy-mm-dd"),dateObj={o:tempDate,k:simpleDate,i:parseInt(simpleDate.replace(/-/gi,""),10),y:tempDate.getFullYear(),m:tempDate.getMonth(),d:tempDate.getDate(),w:tempDate.getDay()};g.push(dateObj)}return common_utils._cache_[flag]=g}};$.extend(!0,String.prototype,{toDate:function(){var rule=this.match(/^(\d{4})-(\d{1,2})-(\d{1,2})( \d{1,2}:\d{1,2}:\d{1,2}(\.\d+)?)?$/);if(rule){var b=rule[1].toInt(),c=rule[2].toInt()-1,rule=rule[3].toInt(),d=new Date(b,c,rule);if(d.getFullYear()==b&&d.getMonth()==c&&d.getDate()==rule)return d}return null},toInt:function(){return parseInt(this.replace(/,/g,""),10)},isDate:function(){var a=this.match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);if(a){var b=a[1].toInt(),c=a[2].toInt()-1,a=a[3].toInt(),d=new Date(b,c,a);if(d.getFullYear()==b&&d.getMonth()==c&&d.getDate()==a)return!0}return!1}});var setting={options:{container:null,reference:!1,step:2,minDate:null,maxDate:null,startDate:null,endDate:null,firstDayOfWeek:1,permit:null,prohibit:null,weekday:"0123456",render:"default",showAlways:!1,showOptions:!1,showWeek:!0,nextEl:null,rangeColor:"#D9E5F4",defaultDate:null,date:null,tipText:"yyyy-mm-dd",zindex:9999,location:"left"},string:{header:"请选择日期",title:"yyyy年m月",week:"星期日 星期一 星期二 星期三 星期四 星期五 星期六".split(" "),weekText:{0:"pic_sun",1:"pic_mon",2:"pic_tue",3:"pic_wed",4:"pic_thu",5:"pic_fir",6:"pic_sat"},todayText:["pic_today","pic_tomorrow","pic_aftertomorrow"]},classNames:{select:"day_selected",nothismonth:"day_over",blankdate:"day_no",tomorrow:"",aftertomorrow:""},listeners:{onBeforeShow:null,onShow:null,onChange:null},template:{wrapper:'<div class="calendar_wrap">\n<div class="calendar_content" id="'+uid+'_dayinfo"></div>\n<a class="month_prev" name="month_prev" href="javascript:void(0);" data-bind="prev"></a>\n<a class="month_next" name="month_next" href="javascript:void(0);" data-bind="next"></a>\n</div>',calendar:function(){var headStr='<div class="calendar_month${monthclass}">\n<div class="calendar_title">${title}</div>\n<dl class="calendar_day">\n',tailStr='\n<dd>\n{{each data}}\n{{if isfestival}}<a href="javascript:void(0);" ${classes}><span class="c_day_festival" ${attr}>${day}</span>{{else}}<a href="javascript:void(0);" ${classes} ${attr}>${day}{{/if}}</a>\n{{/each}}\n</dd>\n</dl>\n</div>',arr=["<dt>一</dt>","<dt>二</dt>","<dt>三</dt>","<dt>四</dt>","<dt>五</dt>",'<dt class="weekend">六</dt>','<dt class="weekend">日</dt>'],midWeek="",firstDayWeek=1;if(_setting.options.firstDayOfWeek&&(firstDayWeek=_setting.options.firstDayOfWeek),(void 0==firstDayWeek||firstDayWeek>6)&&(firstDayWeek=1),0!=firstDayWeek)if(1==firstDayWeek)midWeek+=arr[6];else for(var i=arr.length-firstDayWeek;i<arr.length;i++)midWeek+=arr[i];for(var i=0;i<arr.length-firstDayWeek;i++)midWeek+=arr[i];return headStr+midWeek+tailStr}(),styles:"\n.calendar_wrap{position:relative;display:inline-block;font-size:12px;font-family:tahoma,​Arial,​Helvetica,​simsun,​sans-serif;border:2px solid #61a1df;border-right-width:1px;background:#fff;*display:inline;*zoom:1;box-shadow:0 3px 5px #ccc;}.calendar_content{background:#bbb;}.calendar_month{float:left;overflow:hidden;width:315px;border-right:1px solid #61a1df;}.calendar_title{height:33px;line-height:33px;font-size:14px;font-weight:bold;color:#61a1df;text-align:center;background-color:#fff;border-bottom:1px solid #61a1df;}.month_next,.month_prev{position:absolute;top:7px;width:10px;height:17px;color:#fff;background:url(https://image.zuchecdn.com/calendar/un_calender_index.png) no-repeat;cursor:pointer;cursor:pointer;}.month_prev{left:10px;}.month_next{right:10px;float:right;background-position:100% 0;}.month_prev:hover{background-position:0 -19px;}.month_next:hover{background-position:-35px -19px;}.calendar_day{overflow:hidden;}.calendar_day dt{display:inline;float:left;width:40px;height:24px;line-height:24px;padding-left:5px;color:#323232;}.calendar_day .weekend{color:#f90;}.calendar_day dd{_width:315px;}.calendar_day dd a{float:left;overflow:hidden;width:39px;padding-left:4px;height:39px;line-height:22px;border-top:1px solid #e0e9f2;border-left:1px solid #e0e9f2;border-right:1px solid #fff;border-bottom:1px solid #fff;font-size:12px;font-weight:bold;color:#323232;text-decoration:none;cursor:pointer;}.calendar_day .today,.calendar_day .c_festival_select,.calendar_day .c_festival_select:hover{background:#e6f4ff url(https://image.zuchecdn.com/calendar/un_calender_index.png) no-repeat;}.calendar_day a:hover{background-color:#fff1d6;border:1px solid #fdb811;text-decoration:none;}.calendar_day .today{background-color:#fff5d1;background-position:0 -82px;}.calendar_day .day_over,.calendar_day .day_no{font-weight:normal;color:#b9b9b9;outline:none;cursor:default;}.calendar_day .day_over:hover,.calendar_day .day_no:hover{background:#fff;border-top:1px solid #e0e9f2;border-left:1px solid #e0e9f2;border-right:1px solid #fff;border-bottom:1px solid #fff;}.calendar_day .day_selected,.calendar_day .day_selected:hover{background-color:#fff1d6;border:1px solid #fdb811;}.calendar_day .c_festival_select,.calendar_day .c_festival_select:hover{background-color:#ffe6a6;background-image:url(https://image.zuchecdn.com/calendar/un_calender_index.png);background-position:0 -111px;}.calendar_month.other{width:315px;}.calendar_day .c_festival_select,.calendar_day .c_festival_select:hover{background-color:#ffe6a6;background-image:url(https://image.zuchecdn.com/calendar/un_calender_index.png);background-position:0 -111px;}.c_yuandan span,.c_chuxi span,.c_chunjie span,.c_yuanxiao span,.c_qingming span,.c_wuyi span,.c_duanwu span,.c_zhongqiu span,.c_guoqing span,.c_jintian span,.c_shengdan span{width:39px;height:39px;background-image:url(https://image.zuchecdn.com/calendar/un_festivals.png?v=1);background-repeat:no-repeat;text-indent:-9999em;overflow:hidden;display:block;}.c_yuandan.day_over span,.c_chuxi.day_over span,.c_chunjie.day_over span,.c_yuanxiao.day_over span,.c_qingming.day_over span,.c_wuyi.day_over span,.c_duanwu.day_over span,.c_zhongqiu.day_over span,.c_guoqing.day_over span,.c_jintian.day_over span,.c_shengdan.day_over span{width:39px;height:39px;background-image:url(https://image.zuchecdn.com/calendar/un_festivalsgray.png?v=1);background-repeat:no-repeat;text-indent:-9999em;overflow:hidden;display:block;}.c_yuandan span{background-position:0 0;}.c_chuxi span{background-position:0 -40px;}.c_chunjie span{background-position:0 -80px;}.c_yuanxiao span{background-position:0 -120px;}.c_qingming span{background-position:0 -160px;}.c_wuyi span{background-position:0 -200px;}.c_duanwu span{background-position:0 -240px;}.c_zhongqiu span{background-position:0 -280px;}.c_guoqing span{background-position:0 -320px;}.c_jintian span{background-position:0 -360px;}.c_shengdan span{ background-position: 0 -400px;}.c_calender_date{display:inline-block;color:#666;text-align:right;position:absolute;z-index:1;}.calendar_wrap:before,.calendar_wrap:after{content:'.';display:block;overflow:hidden;visibility:hidden;font-size:0;line-height:0;width:0;height:0;}.calendar_wrap:after{clear:both;}.day_advertisement{font-size:12px;padding:0 20px;margin:0px 5px;color:#8b4932;background:#fff1d6 url(https://image.zuchecdn.com/newversion//common/zc_june_icon_bottom.gif) repeat-x left bottom;}.day_advertisement p{padding:5px 0 12px 55px;margin-top: -6px;line-height:20px;}\n"},festival:{"2018-02-15":["c_chuxi","除夕"],"2017-01-27":["c_chuxi","除夕"],"2016-02-07":["c_chuxi","除夕"],"2015-02-18":["c_chuxi","除夕"],"2014-01-30":["c_chuxi","除夕"],"2013-02-09":["c_chuxi","除夕"],"2018-02-16":["c_chunjie","春节"],"2017-01-28":["c_chunjie","春节"],"2016-02-08":["c_chunjie","春节"],"2015-02-19":["c_chunjie","春节"],"2014-01-31":["c_chunjie","春节"],"2013-02-10":["c_chunjie","春节"],"2018-03-02":["c_yuanxiao","元宵"],"2017-02-11":["c_yuanxiao","元宵"],"2016-02-22":["c_yuanxiao","元宵"],"2015-03-05":["c_yuanxiao","元宵"],"2014-02-14":["c_yuanxiao","元宵"],"2013-02-24":["c_yuanxiao","元宵"],"2018-04-05":["c_qingming","清明"],"2017-04-04":["c_qingming","清明"],"2016-04-04":["c_qingming","清明"],"2015-04-05":["c_qingming","清明"],"2014-04-05":["c_qingming","清明"],"2013-04-04":["c_qingming","清明"],"2018-06-18":["c_duanwu","端午"],"2017-05-30":["c_duanwu","端午"],"2016-06-09":["c_duanwu","端午"],"2015-06-20":["c_duanwu","端午"],"2014-06-02":["c_duanwu","端午"],"2013-06-12":["c_duanwu","端午"],"2018-09-24":["c_zhongqiu","中秋"],"2017-10-04":["c_zhongqiu","中秋"],"2016-09-15":["c_zhongqiu","中秋"],"2015-09-27":["c_zhongqiu","中秋"],"2014-09-08":["c_zhongqiu","中秋"],"2013-09-19":["c_zhongqiu","中秋"],"01-01":["c_yuandan","元旦"],"05-01":["c_wuyi","劳动"],"10-01":["c_guoqing","国庆"],"12-25":["c_shengdan","圣诞"]}},core={_init:function(){this._fragment=$(document.createDocumentFragment()),this.container=$('<div class="calendar_content"></div>'),$("body").append(this.container),this.container.css({position:"absolute",top:0,left:0,width:0,height:0,"z-index":999999}),this.step=1*(_setting.options.step||1),_setting.options.minDate&&(_setting.options.minDate=_setting.options.minDate.toDate()),this.setMinDate(_setting.options.minDate),_setting.options.maxDate&&(_setting.options.maxDate=_setting.options.maxDate.toDate(),this._max=common_utils.parseDateInt(_setting.options.maxDate)),_setting.options.starDate&&(this._start=common_utils.parseDateInt(_setting.options.startDate)),_setting.options.endDate&&(this._end=common_utils.parseDateInt(_setting.options.endDate)),this._initTpl()},showActiveInfo:function(){var a,b,c,d,e,rand=parseInt(10*Math.random()),info="";return rand%2==0?(a="帕萨特",b=1e3,c=200,d=2500,e=500):(a="丰田凯美瑞",b=800,c=150,d=2e3,e=400),a&&(info="老客户租"+a+"≥3天，且总费用超"+b+"元，结算时<span class='red'>立减"+c+"元</span>；租"+a+"≥7天，且总费用超"+d+"元，结算时<span class='red'>立减"+e+"元</span>。注：节日除外；不与周租套餐同享。"),info},_initTpl:function(){var template=_setting.template,n='<hr style="display:none;line-height:0;font-size:0;border:none;" /><style>'+template.styles.replace(/(\s*)([^\{\}]+)\{/g,function(b,d,c){return d+c.replace(/([^,]+)/g,"#"+uid+" $1")+"{"})+"</style>",advertisement='<div class="day_advertisement"><p style="padding:8px 0"><span>国庆特惠：</span><span>9月30日至10月7日期间，在直营门店连续租车≥4天，可获赠2张50元代金券。</span></p></div>',$e=$(document.createElement("div")),offsetEle=$calendarEle,reltop=offsetEle.offset().top,relleft=offsetEle.offset().left,relheight=offsetEle.outerHeight(),relwidth=offsetEle.outerWidth();"right"==_setting.options.location&&(relleft=relleft-318*_setting.options.step+relwidth),$e.attr("id",uid),$e.css({left:relleft,top:reltop+relheight,width:318*_setting.options.step+"px","z-Index":_setting.options.zindex}),((new Date).getTime()>new Date("2015","9","03","24").getTime()||"rent"!=$("#clickpositon").val())&&(advertisement=""),$e.html(n+template.wrapper+advertisement),this._layout=$e,this._content=$("#"+uid+"_dayinfo");var g=this,f=!0;$e.mousedown(function(a){var b=a.target||a.srcElement;g._handleEvent(b),f=!1}).mouseup(function(){f=!0}),_setting.options.showAlways||$(document).click(function(a){$(a.target).closest(".calendar_content").hasClass("calendar_content")||a.target.id==$calendarEle.attr("id")||(g.hide(),f=!0)}),$calendarEle.blur(function(){f&&g.hide()}),this.reference&&(g._tempEnd=!1,$e.mousemove(function(a){g.isIn(g._content,a.target)?g._checkHoverColor(a.target):g._tempEnd&&(g._tempEnd=!1,g.update())}))},setMinDate:function(a){var b=!1;a?b=common_utils.parseDateInt(a):(_setting.options.minDate=now,b=l),this._min=b},isIn:function(a,b){for(var d=b;d&&9!==d.nodeType;){if(d==a)return!0;d=d.parentNode}return!1},_handleEvent:function(a){var b=a.getAttribute("data-bind");if(b)switch(b){case"close":this.hide();break;case"prev":this.changeDrawMonth(-this.step);break;case"next":this.changeDrawMonth(this.step);break;case"select":this.select(a)}return!1},changeDrawMonth:function(a){this._drawDate=common_utils.addMonth(this._drawDate,a),this.update()},show:function(){if(!this._isShow){core.__inst&&core.__inst.uid!=this.uid&&core.__inst.hide(),this._updateOptions();var listeners=_setting.listeners;listeners.onBerforeShow&&listeners.onBerforeShow.call(this),this.container.append(this._layout),this.update(),_setting.options.showAlways||(this._layout.offset($calendarEle),core.__inst=this),listeners.onShow&&listeners.onShow.call(this),this._isShow=!0,this.setPrevAndNext();var homeFlag=$("input[link-input='fromCityId']").attr("home-flag");homeFlag&&"true"==homeFlag&&"rent"==$("#clickpositon").val()?$(".day_advertisement").show():$(".day_advertisement").hide()}},hide:function(){_setting.options.showAlways||this._isShow&&(this._fragment.append(this._layout),this._isShow=!1)},_updateOptions:function(){var b=_setting.options;_setting.options.getMinDate&&"function"==typeof _setting.options.getMinDate&&(_setting.options.minDate=_setting.options.getMinDate().toDate(),this.setMinDate(_setting.options.minDate)),this.setCurrentDate($calendarEle),this._start&&this.currentDate&&(b.endDate=this.currentDate,this._end=this.currentDint),this._parseDrawMonth()},_parseDrawMonth:function(){var a=!1,b=_setting.options;this.currentDate?this._drawDate=this.currentDate:b.defaultDate?a=b.defaultDate.toDate():this._min&&(a=b.minDate,a?this._drawDate=now:(a=now,this._drawDate=a))},setCurrentDate:function(a){a=a.val(),a.isDate()&&(a=a.toDate(),this.isPassDate(a)||(this.currentDate=a,this.currentDint=common_utils.parseDateInt(a)))},update:function(){var a=this.step,b=1;$("#"+uid+"_dayinfo").html("");var currentMonth=this._create(this._drawDate);if(currentMonth&&$("#"+uid+"_dayinfo").append(currentMonth),a>b)for(;b<a;b++){var otherMonth=this._create(common_utils.addMonth(this._drawDate,b),"other");otherMonth&&$("#"+uid+"_dayinfo").append(otherMonth)}if(_setting.options.showOptions){var c=this._layout.find("select"),e=this;c.bind("change",function(){e._drawDate=new Date(c[0].value,1*c[1].value-1,1),e.update()})}this.setPrevAndNext()},setPrevAndNext:function(){var min=194901,max=205001;null!=_setting.options.minDate&&(min=parseInt(common_utils.format(_setting.options.minDate,"yyyymm"),10)),null!=_setting.options.maxDate&&(max=parseInt(common_utils.format(_setting.options.maxDate,"yyyymm"),10));var temMin=parseInt(common_utils.format(this._drawDate,"yyyymm"),10),temMax=parseInt(common_utils.format(common_utils.addMonth(this._drawDate,1),"yyyymm"),10),prev=document.getElementsByName("month_prev"),next=document.getElementsByName("month_next");if(1==this.step&&(temMax=temMin),null!=prev)for(var i=0;i<prev.length;i++)min>=temMin?(prev[i].setAttribute("data-bind",""),$(prev[i]).hide()):(prev[i].setAttribute("data-bind","prev"),$(prev[i]).show());if(null!=next)for(var i=0;i<next.length;i++)max<=temMax?(next[i].setAttribute("data-bind",""),$(next[i]).hide()):(next[i].setAttribute("data-bind","next"),$(next[i]).show())},_create:function(a,b){var d=_setting,l=(d.options,a.getMonth(),d.template,""),k=this._renderCalendar(a);l=common_utils.format(a,d.string.title);var $calendar_month=$('<div class="calendar_month"></div>');b&&$calendar_month.addClass(b),$calendar_month.append($('<div class="calendar_title">'+l+"</div>"));var $calendar_day=$('<dl class="calendar_day"></dl>');$calendar_day.append('<dt class="weekend">日</dt><dt>一</dt><dt>二</dt><dt>三</dt><dt>四</dt><dt>五</dt><dt class="weekend">六</dt>');var $calendar_day_dd=$("<dd></dd>");if(k)return $.each(k,function(i,data){var a=null;data.attr||(data.attr=""),data.isfestival?(a=$('<a href="javascript:void(0);" '+data.classes+"></a>"),a.append($('<span class="c_day_festival" '+data.attr+">"+data.day+"</span>"))):a=$('<a href="javascript:void(0);" '+data.classes+" "+data.attr+">"+data.day+"</a>"),a&&$calendar_day_dd.append(a)}),$calendar_day.append($calendar_day_dd),$calendar_month.append($calendar_day),$calendar_month},_renderCalendar:function(a){var b=common_utils.get(a,_setting.options.firstDayOfWeek),d=a.getMonth(),c=this;a=0;for(var e=[],g=_setting.classNames,l={default:function(a){return a.m==d?c._parseCellDate(a,g,d):{day:"",date:null,classes:' class="'+g.blankdate+'"'}},all:function(a){return c._parseCellDate(a,g,d)}}[_setting.options.render];42>a;a++)e.push(l(b[a]));return e},_checkFestival:function(a){var b=a.substring(5),d=_setting.festival;return a==common_utils.format(new Date,"yyyy-mm-dd")?["c_jintian","今天"]:d[a]?d[a]:!!d[b]&&d[b]},_parseCellDate:function(a,b,d){var c=a.k,f=[];d=a.i;var e=a.w,g=' id="'+c+'"',f=[];return a={day:a.d,date:c,classes:"",attr:""},d==l&&f.push(b.today),this._checkPassDate(c,d,e)?((c=this._checkFestival(c))&&(a.isfestival=!0,f.push(c[0])),f.push(b.nothismonth)):(g+=' data-bind="select"',(c=this._checkFestival(c))&&(a.isfestival=!0,f.push(c[0])),this.currentDate&&this.currentDint==d&&(a.isfestival?f.push("c_festival_select"):f.push(b.select)),this._start&&(this._start==d&&(a.isfestival?f.push("c_festival_select"):f.push(b.select)),this._end&&d>this._start&&d<this._end&&(g+=' style="background-color: '+_setting.options.rangeColor+'"'),this._tempEnd&&d>this._start&&d<this._tempEnd&&(g+=' style="background-color: '+_setting.options.rangeColor+'"'))),0<f.length&&(a.classes=' class="'+f.join(" ")+'"'),a.attr=g,a},isPassDate:function(a){var b=common_utils.format(a),d=common_utils.parseDateInt(a);return a=a.getDay(),this._checkPassDate(b,d,a)},_checkPassDate:function(a,b,d){var c=_setting.options;return!(!c.prohibit||-1===c.prohibit.indexOf(a))||(!c.permit||-1===c.permit.indexOf(a))&&!!(this._min&&b<this._min||this._max&&b>this._max||-1===c.weekday.indexOf(d))},_checkHoverColor:function(a){"select"==a.getAttribute("data-bind")&&(a=a.id)&&(a=common_utils.parseDateInt(a))&&a!=this._tempEnd&&a>this._start&&(this._end?a>this._end&&(this._tempEnd=a,this.update()):(this._tempEnd=a,this.update()))},select:function(a){a=a.id;var b=a.toDate(),d=$calendarEle,n=common_utils.format(b,_setting.options.tipText);$calendarEle.val(a),this.currentDate=b,this.currentDint=common_utils.parseDateInt(b),this.hide();var e=this,g=_setting.listeners;g.onChange&&setTimeout(function(){g.onChange.call(e,d,n,!1)}),$calendarEle.trigger("change"),setTimeout(function(){$(_setting.options.nextEl).focus()}),_setting.options.showWeek&&this.setWeek(),_setting.options.showAlways&&this.update()},getWhatDay:function(a){var b=common_utils.format(a);return string=_setting.string,(b=this._checkFestival(b))?b[0].replace("c_","pic_"):(b=new Date,b=new Date(b.getFullYear(),b.getMonth(),b.getDate()),b=parseInt((a-b)/864e5,10),0<=b&&3>b?string.todayText[b]:string.weekText[a.getDay()])},setWeek:function(a){var b=$calendarEle,a=b.val().toDate();a?(a=this.getWhatDay(a),105<=b.offset().width&&b.css({"background-image":"url(https://image.zuchecdn.com/calendar/"+a+".png)","background-position":"right center","background-repeat":"no-repeat"})):b.css({"background-image":"none"})}};if((_setting=$.extend(!0,setting,_setting))&&_setting.options.date){var date=_setting.options.date.toDate();date&&(now=date)}l=common_utils.parseDateInt(now);var e=!1;_setting.options.showAlways?e||(core._init(),core.show(),e=!0,this._isShow=!1):$calendarEle.focus(function(){e||(core._init(),e=!0),core.show()}).mousedown(function(){e||(core._init(),e=!0),core.show()})}})}(jQuery)}),define("public/lib/jquery/jquery.slide-sz",[],function(require,exports,module){!function($){$.fn.slideJ=function(options){function opacityAnimateJ(){function checkNum(){nowNum<total-1?(toggle_scroll(),nowNum++):(toggle_scroll(),nowNum=0)}function toggle_scroll(n){active=!0,null!=n&&(nowNum=n),slideCl.css({"z-index":"0"}),sildeElem.find("li.selected").css({"z-index":1}),slideCl.eq(nowNum).css({"z-index":"2",opacity:0}),slideCl.eq(nowNum).animate({opacity:1},options.speed,function(){active=!1}),slideNavCl.removeClass("selected"),slideNavCl.eq(nowNum).addClass("selected"),slideCl.removeClass("selected"),slideCl.eq(nowNum).addClass("selected")}$(sildeElem).find("ul").css({position:"relative",height:options.height,width:options.width,overflow:"hidden"}),slideCl.css({position:"absolute"}),slideNavCl.eq(0).addClass("selected"),slideCl.css({opacity:0,"z-index":"0"}),slideCl.eq(0).css({opacity:1,"z-index":"1"});var interval=setInterval(checkNum,options.time);slideNavCl.each(function(index){$(this).click(function(){1!=active&&(nowNum=index,checkNum())})}),$(options.rightBtn).click(function(){1!=active&&checkNum()}),$(options.leftBtn).click(function(){if(1!=active){var nx=nowNum-2,cx=0;-1==nx?(nx=total-1,cx=0):-2==nx?(nx=total-2,cx=total-1):cx=nx+1,toggle_scroll(nx),nowNum=cx}}),options.hoverPause&&(sildeElem.hover(function(){clearInterval(interval),interval=!1},function(){0==interval&&(interval=setInterval(checkNum,options.time))}),slideNavCl.hover(function(){clearInterval(interval),interval=!1},function(){0==interval&&(interval=setInterval(checkNum,options.time))}),slideCl.hover(function(){clearInterval(interval),interval=!1},function(){0==interval&&(interval=setInterval(checkNum,options.time))}))}function slideAnimateJ(){}var defaults={width:"100%",height:$(this).height(),nav:".slideNav",leftBtn:".slideLeft",rightBtn:".slideRight",speed:200,time:4e3,type:"opacity",hoverPause:!0},options=$.extend(defaults,options),sildeElem=$(this),slideCl=sildeElem.find("li"),slideNavCl=$(options.nav).find("a"),total=slideCl.size(),nowNum=1,active=!1,aHideFocus=options.nav+" a,"+options.leftBtn+" a,"+options.rightBtn+" a,"+options.leftBtn+","+options.rightBtn;if($(aHideFocus).attr("hideFocus","hideFocus"),total<=1)return void $(aHideFocus).hide();$(this).css({position:"relative",height:options.height}),this.each(function(){switch(options.type){case"opacity":opacityAnimateJ(options);break;case"slide":slideAnimateJ(options)}})}}(jQuery)}),define("public/lib/jquery/jquery.cityport",[],function(require,exports,module){!function($){var gaodemap=require("som/ref/index/door");$.fn.extend({cityPort:function(options){function json(humpPinyins,enName,name,code,home,top,szm,tour,newflag){this.humpPinyins=humpPinyins||"",this.enName=enName||"",this.name=name||"",this.code=code||"",this.home=void 0!==home&&home,this.top=void 0!==top&&top,this.tour=void 0!==tour&&tour,this.szm=szm||"",this.index=index(this.enName),this.newflag=void 0!==newflag&&newflag}function index(enName){var ind,i=enName.toUpperCase().charCodeAt(0);return i<=68?ind=1:i<=74?ind=2:i<=81?ind=3:i<=87?ind=4:i<=90&&(ind=5),ind}function arrayIndexOf(newcitylist,name){var isindex=!1;if(newcitylist)for(var i=0,len=newcitylist.length;i<len;i++)if(newcitylist[i]==name){isindex=!0;break}return isindex}_CONF={oldValue:"选择城市",data:[],pickCity:"",pickCityClick:function(obj){},returnCity:"",returnCityClick:function(obj){},onfocus:function(obj){},hide_upw:!1};for(var __opt=$.extend(_CONF,options),cityportList=[],TOPCITY=[],TOURCITY=[],i=0,len=__opt.data.length;i<len;i++)(""+__opt.data[i].code).match(/^[a-zA-Z0-9]+$/g)&&cityportList.push(new json(__opt.data[i].humpPinyins,__opt.data[i].enName,__opt.data[i].name,__opt.data[i].code,__opt.data[i].home,__opt.data[i].top,__opt.data[i].szm,__opt.data[i].tour,__opt.data[i].newflag)),(__opt.data[i].top&&"false"!=__opt.data[i].top||"true"==__opt.data[i].top)&&TOPCITY.push(new json(__opt.data[i].humpPinyins,__opt.data[i].enName,__opt.data[i].name,__opt.data[i].code,__opt.data[i].home,__opt.data[i].top,__opt.data[i].szm)),(__opt.data[i].tour&&"false"!=__opt.data[i].tour||"true"==__opt.data[i].tour)&&TOURCITY.push(new json(__opt.data[i].humpPinyins,__opt.data[i].enName,__opt.data[i].name,__opt.data[i].code,__opt.data[i].home,__opt.data[i].top,__opt.data[i].szm,__opt.data[i].tour));for(var enName,firstletter,list=[[],[],[],[],[],[],[]],newcitylist=[],imgurl="",cityinfo="",firstletterlist=[],indexletterlist=[],j=0,m=0,k=0,i=0,len=cityportList.length;i<len;i++)cityportList[i].index&&(cityportList[i].newflag?newcitylist.push(cityportList[i].name):imgurl="",enName=cityportList[i].enName,firstletter=enName.substring(0,1),firstletter=firstletter.toUpperCase(),arrayIndexOf(firstletterlist,firstletter)||(firstletterlist.push(firstletter),j>0&&firstletter!=firstletterlist[j-1]&&m>0&&cityportList[i].index==indexletterlist[m-1]&&(cityinfo+="</div>"),cityinfo+="<div class='letterbox'><b class='cityzmletter'>"+firstletter+"</b>",j++),arrayIndexOf(indexletterlist,cityportList[i].index)||(indexletterlist.push(cityportList[i].index),m++),"jiangyin"==cityportList[i].enName&&"481"==cityportList[i].code?cityinfo+='<span class="new" title="新开通城市，欢迎光临！" enName="'+cityportList[i].enName+'" code="'+cityportList[i].code+'" home="'+cityportList[i].home+'">'+cityportList[i].name+imgurl+"</span>":cityinfo+='<span enName="'+cityportList[i].enName+'" code="'+cityportList[i].code+'" home="'+cityportList[i].home+'">'+cityportList[i].name+imgurl+"</span>",k++,k==cityportList[i].length&&(cityinfo+="</div>",k=0),list[cityportList[i].index+1].push(cityinfo),cityinfo="");var TOPCITY_beijing=$.grep(TOPCITY,function(obj){return 1==obj.code}),TOPCITY_shanghai=$.grep(TOPCITY,function(obj){return 6==obj.code}),TOPCITY_guangzhou=$.grep(TOPCITY,function(obj){return 14==obj.code}),TOPCITY_shenzhen=$.grep(TOPCITY,function(obj){return 15==obj.code}),TOPCITY_other=$.grep(TOPCITY,function(obj){return 1!=obj.code&&6!=obj.code&&14!=obj.code&&15!=obj.code});TOPCITY=TOPCITY_beijing.concat(TOPCITY_shanghai).concat(TOPCITY_guangzhou).concat(TOPCITY_shenzhen).concat(TOPCITY_other);for(var i=0,len=TOPCITY.length;i<len;i++)newcitylist&&arrayIndexOf(newcitylist,TOPCITY[i].name)||(imgurl=""),"jiangyin"==TOPCITY[i].enName&&"481"==TOPCITY[i].code?list[0].push('<span class="new" title="新开通城市，欢迎光临！" code="'+TOPCITY[i].code+'" enName="'+TOPCITY[i].enName+'" home="'+TOPCITY[i].home+'">'+TOPCITY[i].name+imgurl+"</span>"):list[0].push('<span code="'+TOPCITY[i].code+'" enName="'+TOPCITY[i].enName+'" home="'+TOPCITY[i].home+'">'+TOPCITY[i].name+imgurl+"</span>");for(var i=0,len=TOURCITY.length;i<len;i++)newcitylist&&arrayIndexOf(newcitylist,TOURCITY[i].name)||(imgurl=""),"jiangyin"==TOURCITY[i].enName&&"481"==TOURCITY[i].code?list[1].push('<span class="new" title="新开通城市，欢迎光临！" code="'+TOURCITY[i].code+'" enName="'+TOURCITY[i].enName+'" home="'+TOURCITY[i].home+'">'+TOURCITY[i].name+imgurl+"</span>"):list[1].push('<span code="'+TOURCITY[i].code+'" enName="'+TOURCITY[i].enName+'" home="'+TOURCITY[i].home+'">'+TOURCITY[i].name+imgurl+"</span>");var cityHtml='<div id="popup_pane" class="popup_pane" oncopy="return false;" style="display:none">';return 0==__opt.hide_upw?(cityHtml+='<div class="popupdivh3"><h3>&nbsp;</h3><p></p></div>',cityHtml+='<div id="popup_pane_head">'):cityHtml+='<div id="popup_pane_head" style="border: 2px solid #61a1df;">',cityHtml+='<ul class="popup_title"><li class="cur" t_id="0">热门城市</li><li t_id="1">旅游城市</li><li t_id="2">ABCD</li><li t_id="3">EFGHJ</li><li t_id="4">KLMNPQ</li><li t_id="5">RSTW</li><li t_id="6">XYZ</li></ul><ul id="popup_content"><li class="cur">'+list[0].join("")+"</li><li>"+list[1].join("")+"</li><li>"+list[2].join("")+"</li><li>"+list[3].join("")+"</li><li>"+list[4].join("")+"</li><li>"+list[5].join("")+"</li><li>"+list[6].join("")+"</li></ul></div></div>",this.each(function(){function init_focus_suggest(thisobj){var reltop=$this.offset().top,relleft=$this.offset().left,relheight=$this.outerHeight(),relwidth=$this.outerWidth();$(".citySD").removeClass("iptSeupcur"),$("#popup_pane").remove(),$("body").append(cityHtml),$("#popup_pane").css({left:relleft,top:reltop+relheight}).show(),$this.addClass("iptSeupcur"),$(".popupdivh3, .popupdivh3 p, .popupdivh3 h3").css({width:relwidth-2}),$(".popup_pane").outerHeight(),$("#popup_content li span").unbind("mousedown").bind("mousedown",function(e){$(".popup_pane").hide(),$(".moreCity_arrowBlueUp").hide(),$this.removeClass("iptSeupcur");var city=$(this).html();city&&-1!=city.indexOf("<img")&&(city=city.substring(city,city.indexOf("<img")));var cityId=$(this).attr("code");$this.removeClass("citySU redwords redbd").addClass("citySD bluewords").val(city),$(linkinput).val(cityId),clickTrigger($(this)),gaodemap.addDiyTag()}).bind("mouseover",function(e){$(this).addClass("cur-city")}).bind("mouseout",function(e){$(this).removeClass("cur-city")}),$(".popup_title li").bind("click",function(e){var n=$(this).attr("t_id");$(".popup_title li").removeClass("cur").eq(n).addClass("cur"),$("#popup_content li").removeClass("cur").eq(n).addClass("cur")})}function init_keyup_suggest(obj){a_page&&a_page>1||(a_page=1),a_totalPage=1;for(var args=[],len=pagesize<=TOPCITY.length?pagesize:TOPCITY.length,i=0;i<len;i++){var t_id=Math.ceil((i+1)/len);args.push("<li t_id="+t_id+' enName="'+TOPCITY[i].enName+'" code="'+TOPCITY[i].code+'" home="'+TOPCITY[i].home+'"><div class="f-left">'+TOPCITY[i].name+"</div>"+(TOPCITY[i].szm?'<div class="f-right">'+TOPCITY[i].szm+"</div></li>":""))}$("#city_tips_info").find("li").unbind().remove().end().append(args.join("")).find("li").eq(0).addClass("cur"),$("#city_b_pager").hide(),bindcityclick(obj)}function init_keyup_suggest_array(obj,arr){a_page&&a_page>1||(a_page=1),a_totalPage=1;var args=[],TMPCITY=new Array;for(j=0;j<arr.length;j++)for(var i=0;i<cityportList.length;i++)arr[j]==cityportList[i].code&&TMPCITY.push(cityportList[i]);for(var len=pagesize<=TMPCITY.length?pagesize:TMPCITY.length,i=0;i<len;i++){var t_id=Math.ceil((i+1)/len);args.push("<li t_id="+t_id+' enName="'+TMPCITY[i].enName+'" code="'+TMPCITY[i].code+'" home="'+TMPCITY[i].home+'"><div class="f-left">'+TMPCITY[i].name+"</div>"+(TMPCITY[i].szm?'<div class="f-right">'+TMPCITY[i].szm+"</div></li>":""))}$("#city_tips_info").find("li").unbind().remove().end().append(args.join("")).find("li").eq(0).addClass("cur"),$("#city_b_pager").hide(),bindcityclick(obj)}function reload_tourcities(obj){a_page&&a_page>1||(a_page=1),a_totalPage=1;for(var args=[],len=pagesize<=TOURCITY.length?pagesize:TOURCITY.length,i=0;i<len;i++){var t_id=Math.ceil((i+1)/len);args.push("<li t_id="+t_id+' enName="'+TOURCITY[i].enName+'" code="'+TOURCITY[i].code+'" home="'+TOURCITY[i].home+'"><div class="f-left">'+TOURCITY[i].name+"</div>"+(TOURCITY[i].szm?'<div class="f-right">'+TOURCITY[i].szm+"</div></li>":""))}$("#city_tips_info").find("li").unbind().remove().end().append(args.join("")).find("li").eq(0).addClass("cur"),$("#city_b_pager").hide(),bindcityclick(obj)}function bindcityclick(obj){$("#city_tips_info li").mousedown(function(){var city=$(this).find(".f-left").text(),cityId=$(this).attr("code"),CITYIDREF="#"+$(obj).attr("link-input");$(CITYIDREF).val(cityId),$(obj).val(city).removeClass("citySU redwords redbd").addClass("citySD bluewords"),$("#city_down_tips").hide(),$this.removeClass("iptSeupcur"),clickTrigger($(this)),$(".moreCity_arrowBlueUp").hide()})}function clickTrigger(divobj){if(__opt.pickCity&&$this.attr("id")==__opt.pickCity){var home=$(divobj).attr("home"),enName=$(divobj).attr("enName");__opt.pickCityClick(home,enName)}else if(__opt.returnCity&&$this.attr("id")==__opt.returnCity){var home=$(divobj).attr("home"),enName=$(divobj).attr("enName");__opt.returnCityClick(home,enName)}}function prev_(){count=0,a_page=a_page>1?a_page-1:a_totalPage,$("#city_tips_info li").removeClass("cur").hide(),$("li[t_id="+a_page+"]").removeClass("cur").eq(count).addClass("cur"),$("li[t_id="+a_page+"]").show(),$("#city_b_pager").text(a_page+"/"+a_totalPage)}function next_(){count=0,a_page=a_page<a_totalPage?a_page+1:1,$("#city_tips_info li").removeClass("cur").hide(),$("li[t_id="+a_page+"]").removeClass("cur").eq(count).addClass("cur"),$("li[t_id="+a_page+"]").show(),$("#city_b_pager").text(a_page+"/"+a_totalPage)}function up_(){count--,$("#city_tips_info li").hide(),$("li[t_id="+a_page+"]").show(),count>=0?$("li[t_id="+a_page+"]").removeClass("cur").eq(count).addClass("cur"):(count=$("li[t_id="+a_page+"]").length-1,$("li[t_id="+a_page+"]").removeClass("cur").eq(count).addClass("cur"))}function down_(){count++;var max_l=$("li[t_id="+a_page+"]").length-1;$("#city_tips_info li").hide(),$("li[t_id="+a_page+"]").show(),count<=max_l?$("li[t_id="+a_page+"]").removeClass("cur").eq(count).addClass("cur"):(count=0,$("li[t_id="+a_page+"]").removeClass("cur").eq(count).addClass("cur"))}function reload_data(str,obj,reset){for(var len=cityportList.length,arr=[],n=1,i=0;i<len;i++){var n_flag=cityportList[i].name.indexOf(str)>=0,e_flag=str.length>=3&&0==cityportList[i].enName.toUpperCase().indexOf(str),py_flag=isStartWith(cityportList[i].humpPinyins,str),name_code=cityportList[i].name+" "+cityportList[i].code,a_flag=name_code.toUpperCase().indexOf(str)>=0;if(n_flag||e_flag||a_flag||py_flag){var t_id=Math.ceil(n/pagesize);n++,arr.push("<li t_id="+t_id+' enName="'+cityportList[i].enName+'" code="'+cityportList[i].code+'" home="'+cityportList[i].home+'"><div class="f-left">'+cityportList[i].name+(cityportList[i].szm?'</div><div class="f-right">'+cityportList[i].szm+"</div></li>":""))}}var l=arr.length;if(reset&&(a_page=1),a_totalPage=l%pagesize==0?l/pagesize:Math.floor(l/pagesize)+1,l>pagesize)$("#city_tips_info").find("li").remove().end().append(arr.join("")),$("li[t_id="+a_page+"]").eq(count).addClass("cur"),$("#city_b_pager").text(a_page+"/"+a_totalPage),$("#city_b_pager").show(),$("#a_error_info").hide(),bindcityclick(obj);else if(l>0)$("#city_tips_info").find("li").remove().end().append(arr.join("")),$("li[t_id="+a_page+"]").eq(count).addClass("cur"),$("#city_b_pager,#a_error_info").hide(),bindcityclick(obj);else{var url=carwsomURL+"/api/city/searchcities.do",citydivide=$("#citydivide").val();"1"==citydivide&&(url+="?ishidechainstore="+citydivide),$.ajax({url:url,type:"get",data:{keyword:encodeURI(encodeURIComponent(str))},async:!1,dataType:"jsonp",error:function(){},success:function(data){data&&data.length>0?(init_keyup_suggest_array(obj,data),$("#a_error_info").html("请输入拼音，用↑↓← →选择").show()):(init_keyup_suggest(obj),$(".a_top_title").css({background:"#fff"}),$("#a_error_info").html("对不起，找不到："+str).show(),$("#city_b_pager").hide())}})}}function isStartWith(arr,str){if(arr&&arr.length>0&&str)for(var i=0;i<arr.length;i++)if(arr[i]&&0==arr[i].indexOf(str))return!0;return!1}var a_page=1,a_totalPage=1,count=0;pagesize=8;var wd="",$this=$(this),linkinput="#"+$this.attr("link-input");$this.bind("focus",function(e){__opt.hide_upw&&1==__opt.hide_upw&&$(".moreCity_arrowBlueUp").show(),$(".areaSelection").html(""),$(".selectfromstore").removeClass("iptSeupcur"),__opt.onfocus($this),$this.val($(this).val()).removeClass("redbd redwords"),$(linkinput).val(""),$("#city_down_tips").remove(),$this.attr("t_popup","0"),init_focus_suggest($this)}).bind("keyup",function(e){$this.removeClass("citySD").addClass("citySU");var code=e.keyCode,text=$("#city_tips_info li.cur").find(".f-left").text(),citycode=$("#city_tips_info li.cur").attr("code");if(9!=code){$(".popup_pane").remove(),$this.addClass("bluewords"),$("#city_down_tips").length<=0&&$("body").append('<div id="city_down_tips" class="city_down_tips" style="display:none"><div class="keydivh3"><p></p></div><div class="a_top_title"><div id="a_error_info" style="white-space:nowrap;"></div><font color="red">请输入拼音，用↑↓← →选择</font></div><ul id="city_tips_info"></ul><div id="city_b_pager"></div></div>');var tops=$this.offset().top,left=$this.offset().left,h=tops+$this.outerHeight(),w=$this.outerWidth();if($("#city_down_tips").css({left:left,top:h,width:w-2}).show(),w>160&&$(".a_top_title").css({width:w-12}),$(".keydivh3, .keydivh3 p, .keydivh3 h3").css({width:w-2}),""==$.trim($this.val()))init_keyup_suggest($this);else if(""!=$.trim($this.val())&&40!=code&&38!=code){reload_tourcities($this);var reset=!wd||$this.val().toUpperCase()!=wd;wd=$this.val().toUpperCase(),reload_data($this.val().toUpperCase(),$this,reset)}37==code?a_totalPage>1&&a_page>1&&prev_():38==code?up_():39==code?1!=a_totalPage&&next_():40==code?down_():13==code&&(""!=text&&($this.val(text).removeClass("citySU redwords redbd").addClass("citySD bluewords"),$(linkinput).val(citycode),a_page=1,count=0,clickTrigger($("#city_tips_info li.cur")),$(".moreCity_arrowBlueUp").hide()),$("#city_down_tips").hide())}}),$this.bind("blur",function(e){e.stopPropagation;var cityname=$.trim($this.val());if($(linkinput).val(),cityname)for(var i=0,len=cityportList.length;i<len;i++){if(cityname==cityportList[i].name){$(linkinput).val(cityportList[i].code);break}if(cityname.toUpperCase()==cityportList[i].enName.toUpperCase()){$this.val(cityportList[i].name),$(linkinput).val(cityportList[i].code);break}$(linkinput).val(""),$this.removeClass("citySU redwords").addClass("citySD bluewords")}else $this.val(__opt.oldValue),$this.removeClass("citySU bluewords").addClass("citySD");$("#city_down_tips").hide(),$(".moreCity_arrowBlueUp").hide()}),$(document).click(function(e){$(e.target).closest("#city_down_tips").hasClass("city_down_tips")||$("#city_down_tips").remove();var btn_flag=$(e.target).attr("t_popup"),div_flag=$(e.target).closest(".popup_pane").hasClass("popup_pane");"0"==btn_flag||div_flag||($(".popup_pane").remove(),$(".paircitySelection,.citySelection").removeClass("iptSeupcur"),$(".moreCity_arrowBlueUp").hide())})})}})}(jQuery)}),define("som/ref/index/door",[],function(require,exports,module){function doNearByResearch(cpoint){var MSearch;AMap.service(["AMap.PlaceSearch"],function(){MSearch=new AMap.PlaceSearch({pageSize:19,pageIndex:1,city:gaodemap.cityname}),MSearch.searchNearBy(null,cpoint,1e3,function(status,result){"complete"===status&&"OK"===result.info&&keywordSearch_CallBack(result)})})}function nearbySearch_CallBack(data){var poiArr=data.poiList.pois;poiArr=handFavoritesFn(poiArr);var html=$("#poisTemplate").render({poisList:eval(poiArr)});$("#search-part").append(html),bindEvent(),$("#search-part").show()}function addMapCenterMarker(location){var iconurl=carwrmimageURL+"/newversion/door/icon_point_song.png",sentOrPickType=$("#sentOrPickType").val();sentOrPickType&&"pickCar"==sentOrPickType&&(iconurl=carwrmimageURL+"/newversion/door/icon_point_qu.png");var markerOption={map:gaodemap.mapObj,position:location,icon:iconurl,offset:new AMap.Pixel(-18,-40)};gaodemap.mar?gaodemap.mar.setPosition(location):(gaodemap.mar=new AMap.Marker(markerOption),gaodemap.mar.setTop(!0))}function regeoCoder(lnglatXY,callback){var MGeocoder;AMap.service(["AMap.Geocoder"],function(){MGeocoder=new AMap.Geocoder({radius:1e3,extensions:"base"}),MGeocoder.getAddress(lnglatXY,function(status,result){"complete"===status&&"OK"===result.info&&(callback?callback(result,lnglatXY):geocoder_CallBack(result,lnglatXY))})})}function isInCityRange(district,city,province){return!(!city||""==city||!(city.indexOf(gaodemap.cityname)>-1||gaodemap.cityname.indexOf(city)>-1))||(!(!district||""==district||!(district.indexOf(gaodemap.cityname)>-1||gaodemap.cityname.indexOf(district)>-1))||!(!province||""==province||!(province.indexOf(gaodemap.cityname)>-1||gaodemap.cityname.indexOf(province)>-1)))}function geocoder_CallBack(data){if(data.regeocode.addressComponent.building&&(name=data.regeocode.addressComponent.building),!isInCityRange(data.regeocode.addressComponent.district,data.regeocode.addressComponent.city,data.regeocode.addressComponent.province))return void alert("您查看的范围超出"+gaodemap.cityname+"啦");var location=gaodemap.mar.getPosition();gaodemap.mapObj.setCenter(gaodemap.mar.getPosition()),doNearByResearch(location)}function checkStoreStatus(){var isDefaultFromValue="请选择取车门店"===$("#fromStoreName").val(),isDefaultToValue="请选择还车门店"===$("#toStoreName").val();return{isFromDiy:!isDefaultFromValue&&!gaodemap.homeSend&&1==$("#fromStoreName").attr("data-isdiy"),isToDiy:!isDefaultToValue&&!gaodemap.homeReturn&&1==$("#toStoreName").attr("data-isdiy")}}function clearTags(storeType){var storeType=storeType||3,fromStoreSelector="#backCarAddress";toStoreSelector="#returnCarAddress",storeSelector="",fromContainerSelector1=".zc_item_cont.from_store",toContainerSelector1=".zc_item_cont.to_store",fromContainerSelector2=".ch_box.ch_box_from",toContainerSelector2=".ch_box.ch_box_to",containerSelector="",1==storeType?(storeSelector=fromStoreSelector,containerSelector=fromContainerSelector1+", "+fromContainerSelector2):2==storeType?(storeSelector=toStoreSelector,containerSelector=".zc_headlist, "+toContainerSelector1+", "+toContainerSelector2):3==storeType&&(storeSelector=fromStoreSelector+", "+toStoreSelector,containerSelector=".zc_headlist, .zc_item_cont, .ch_box"),$(fromContainerSelector2).length>0&&1==storeType?$(fromContainerSelector2).addClass("space"):$(fromContainerSelector2).removeClass("space"),$(storeSelector).attr("data-isdiy","0"),$(containerSelector).removeClass("prevdiy diy")}function doMapResearch(keyword){var MSearch;AMap.service(["AMap.PlaceSearch"],function(){MSearch=new AMap.PlaceSearch({pageSize:20,pageIndex:1,city:gaodemap.cityname}),MSearch.search(keyword,function(status,result){"complete"===status&&"OK"===result.info&&keywordSearch_CallBack(result)})})}function keywordSearch_CallBack(data){var poiArr=data.poiList.pois;poiArr=handFavoritesFn(poiArr);var d=poiArr[0];d.isSel=!0;var html=$("#poisTemplate").render({poisList:eval(poiArr)});$("#search-part").html(html),gaodemap.mar&&gaodemap.mapObj.remove(gaodemap.mar),gaodemap.mar=null,addMapCenterMarker(d.location),bindEvent(),gaodemap.mapObj.setZoomAndCenter(15,d.location),checkIsInPoly(d.location)||gaodemap.mapObj.setFitView(),$("#search-part").show(),$("#collect-part").hide(),$(".down-icon").hide(),$("#collect").removeClass("down-on")}function bindPlaceSearch(){$(".search-con .btn-search").click(function(){var inputVal=$("#searchText").val(),defalutvalue=$("#searchTextShowVal").attr("defalutvalue");inputVal&&defalutvalue!=inputVal&&doMapResearch(inputVal)})}!function(){var mapTextarea=$("#J_gaodemapLoad"),mapScript=mapTextarea.val();if(mapScript){var DOMmapScript=document.createElement("script"),srcReg=/src=\"(.+?)\"/g,typeReg=/type=\"(.+?)\"/g,src=srcReg.exec(mapScript)[1],scriptType=typeReg.exec(mapScript)[1];DOMmapScript.type=scriptType,DOMmapScript.src=src,mapTextarea.parents()[0].appendChild(DOMmapScript),mapTextarea.remove(),DOMmapScript.onload=function(){}}}();var zuche_maskplayer=require("public/common/szmasklayer"),commonUtils=require("public/common/common_utils"),stringUtils=require("public/utils/stringutils"),gaodemap={};gaodemap.mapObj=null,gaodemap.cityname="北京",gaodemap.cityId="1",gaodemap.mar=null,gaodemap.mar_infoContent=null,gaodemap.geolocation=null,gaodemap.isfirstgeo=!1,gaodemap.polygons=[],gaodemap.isSendstoreDiy=!1,gaodemap.isPickstoreDiy=!1,gaodemap.homeSend=!1,gaodemap.homeReturn=!1,gaodemap.syncStoreInfo=!1,gaodemap.createMap=function(){gaodemap.mapObj=new AMap.Map("map_div2",{resizeEnable:!0,view:new AMap.View2D({resizeEnable:!0,zoom:15}),keyboardEnable:!1}),gaodemap.mapObj.setCity(gaodemap.cityname),gaodemap.initPoly(),gaodemap.initMap()},gaodemap.initMap=function(){gaodemap.clickEventListener=AMap.event.addListener(gaodemap.mapObj,"click",function(e){if(!checkIsInPoly(new AMap.LngLat(e.lnglat.getLng(),e.lnglat.getLat())))return zuche_maskplayer.notifyDialogBtnNew("此位置已超出上门送取范围，请选择蓝色区域内地点，或选择<a id='toddqh' href='javascript:void(0)'>到店取还</a>前往附近门店。","","我知道了"),void $("#toddqh").click(function(){zuche_maskplayer.close(),toddqhurl()});addMapCenterMarker(e.lnglat),regeoCoder(new AMap.LngLat(e.lnglat.getLng(),e.lnglat.getLat()))})},gaodemap.initPoly=function(takeCityId){gaodemap.polygons=[];var polyArr=getFindFenceList(takeCityId);polyArr&&$.each(polyArr,function(i,polyObj){polyObj&&gaodemap.initEachPoly(polyObj.electronicFenceDetailList)})};var toddqhurl=function(){var $indexTabsli=$(".indexTabs li");$indexTabsli.eq(0).hasClass("cur")?$indexTabsli.eq(1).click():$indexTabsli.eq(1).hasClass("cur")?($("#shangmensongche").removeClass("s_open"),$("#shangmequche").removeClass("s_open")):$(".zc_menu li").eq(1).hasClass("cur")?window.location=orderURL+"/smfw/index.do?flag=2":$(".zc_menu li").eq(2).hasClass("cur")&&($("#fromStoreName").val($("#fromStoreName").attr("default-value")),$("#fromStoreId").val(""),$("#fromStoreName").show(),$("#fromStoreName").attr("isChain",0),$("#sentAddress").hide(),$("#senttype").val(0),$("#showsentAddress_checkbox").removeClass("checked"),$("#sentCarLng").val(""),$("#sentCarLat").val(""),$("#showpickAddress_span2").removeClass("checked"),$(".pickCarTips").hide(),$("#toStoreName").val($("#toStoreName").attr("default-value")),$("#toStoreName").attr("isChain",0),$("#toStoreId").val(""),$("#toStoreName").show(),$("#pickAddress").hide(),$("#picktype").val(0),$("#pickCarLng").val(""),$("#pickCarLat").val(""))},checkIsInPoly=function(lnglat){for(var i=0;i<gaodemap.polygons.length;i++)if(gaodemap.polygons[i]&&gaodemap.polygons[i].contains(lnglat))return!0;return!1};gaodemap.initEachPoly=function(electronicFenceDetailList){if(!electronicFenceDetailList)return void alert("该城市没有电子围栏");var poiArr=[];if($.each(electronicFenceDetailList,function(i,poiObj){if(poiObj){var lat=poiObj.lat,lng=poiObj.lng;lng&&lat&&"0.0"!=lng&&"0.0"!=lat&&poiArr.push([lng,lat])}}),poiArr){var polygon=new AMap.Polygon({map:gaodemap.mapObj,path:poiArr,strokeColor:"#2b99ff",strokeOpacity:1,strokeWeight:2,fillColor:"#2b99ff",fillOpacity:.1});gaodemap.clickEventListener=AMap.event.addListener(polygon,"click",function(e){addMapCenterMarker(e.lnglat),regeoCoder(new AMap.LngLat(e.lnglat.getLng(),e.lnglat.getLat()))}),gaodemap.polygons.push(polygon)}};var addMapCenterMarkerByLnglat=function(lng,lat){if(lng&&lat&&"0.0"!=lng&&"0.0"!=lat){var lnglat=new AMap.LngLat(lng,lat);gaodemap.mapObj.setCenter(lnglat),addMapCenterMarker(lnglat)}else doMapResearch(gaodemap.cityname)},refreshMapByLaglat=function(lng,lat,cityid){if(gaodemap.mapObj=null,gaodemap.mar=null,gaodemap.init(),lng&&lat&&"0.0"!=lng&&"0.0"!=lat){var lnglat=new AMap.LngLat(lng,lat);setTimeout(function(){addMapCenterMarker(lnglat),gaodemap.mapObj.setZoomAndCenter(15,lnglat)},1e3);var pois=new Array,sentOrPickType=$("#sentOrPickType").val(),addressInfo=null;"sentCar"==sentOrPickType?addressInfo=commonUtils.zuche_cookieUtil.getValue("sentAddressDetail"):"pickCar"==sentOrPickType&&(addressInfo=commonUtils.zuche_cookieUtil.getValue("pickAddressDetail"));var address="",name="";if(addressInfo){var addressInfos=addressInfo.split("|");addressInfos&&(address=addressInfos[0],name=addressInfos[1]),pois.unshift({name:name,location:lnglat,address:address}),pois=handFavoritesFn(pois);var html=$("#poisTemplate").render({poisList:eval(pois)});$("#search-part").html(html),gaodemap.mapObj.setZoomAndCenter(15,lnglat)}bindEvent()}else doMapResearch(gaodemap.cityname)},handFavoritesFn=function(poiArr){var doorInfoFavoritesVal=commonUtils.zuche_cookieUtil.getValue("doorInfoFavorites"),starFlag="noStar";if(poiArr&&doorInfoFavoritesVal){doorInfoFavoritesVal=JSON.parse(doorInfoFavoritesVal);for(var i=0;i<poiArr.length;i++){var poiObj=poiArr[i];if(poiObj){var lng=poiObj.location.getLng(),lat=poiObj.location.getLat(),name=poiObj.name;if(lng&&lat&&"0.0"!=lng&&"0.0"!=lat)for(var j=0;j<doorInfoFavoritesVal.length;j++){var doorInfoObj=doorInfoFavoritesVal[j];if(doorInfoObj){var dorKeyParam=lng+"|"+lat+"|"+name,doorKey=doorInfoObj.doorKey;if(doorKey&&doorKey==dorKeyParam){starFlag="hasStar",poiObj.starFlag=starFlag,poiArr[i]=poiObj;break}}}}}}return poiArr},bindEvent=function(){$("#search-part .loca").click(function(){$(this).toggleClass("loca-on")}),$(".star").die().live("click",function(){var doorInfoFavoritesVal=commonUtils.zuche_cookieUtil.getValue("doorInfoFavorites"),$parentli=$(this).parent().parent().parent(),lng=$parentli.attr("lng"),lat=$parentli.attr("lat"),name=$parentli.attr("name"),address=$parentli.attr("address");if(lng&&lat&&"0.0"!=lng&&"0.0"!=lat&&(name||address)){$(this).toggleClass("star-on");var starOnFlag=$(this).hasClass("star-on"),floatboxClass="floatbox_on",floatboxText="设为常用地址",floatboxHtml=null;starOnFlag||(floatboxClass="floatbox_off",floatboxText="取消常用"),floatboxHtml='<div class="'+floatboxClass+'"><span>'+floatboxText+"</span></div>",floatboxHtml&&($(this).nextAll().remove(),$(this).after(floatboxHtml),$(this).next("."+floatboxClass).show());var sentOrPickType=$("#sentOrPickType").val(),cityId=null,cityName=null;sentOrPickType&&("sentCar"==sentOrPickType?(cityId=$("#fromCityId").val(),cityName=$("input[link-input='fromCityId']").val()):"pickCar"==sentOrPickType&&(cityId=$("#toCityId").val(),cityName=$("#toCityName").val()));var doorInfoVal={},dorKeyVal=lng+"|"+lat+"|"+name;if(doorInfoVal.doorKey=dorKeyVal,doorInfoVal.doorDetail={lng:lng,lat:lat,name:name,address:address,cityId:cityId,cityName:cityName},doorInfoFavoritesVal){doorInfoFavoritesVal=JSON.parse(doorInfoFavoritesVal);for(var i=0;i<doorInfoFavoritesVal.length;i++){var doorInfoObj=doorInfoFavoritesVal[i];if(doorInfoObj){if(dorKeyVal==doorInfoObj.doorKey){doorInfoFavoritesVal.splice(i,1);break}}}}else doorInfoFavoritesVal=[];starOnFlag&&doorInfoFavoritesVal instanceof Array&&doorInfoFavoritesVal.unshift(doorInfoVal),"string"!=typeof doorInfoFavoritesVal&&(doorInfoFavoritesVal=JSON.stringify(doorInfoFavoritesVal)),commonUtils.zuche_cookieUtil.add("doorInfoFavorites",doorInfoFavoritesVal,8760)}}),$(".star").mouseout(function(){$(this).nextAll().remove()}),$(".address-con ul li").click(function(){$(this).siblings("li").removeClass("current"),$(this).addClass("current"),gaodemap.mar_infoContent=$(this).attr("address"),addMapCenterMarkerByLnglat($(this).attr("lng"),$(this).attr("lat"))}),$(".btn-submit").click(function(){var $parentli=$(this).parent().parent(),lng=$parentli.attr("lng"),lat=$parentli.attr("lat"),name=$.trim($parentli.attr("name"));name="[位置]"==name?"":name;var address=$.trim($parentli.attr("address")),downonFlag=$("#collect").hasClass("down-on"),doorInfoFavoritesVal=commonUtils.zuche_cookieUtil.getValue("doorInfoFavorites"),cityId=null,cityName=null;if(downonFlag&&doorInfoFavoritesVal){var dorKeyParam=lng+"|"+lat+"|"+name;doorInfoFavoritesVal=JSON.parse(doorInfoFavoritesVal);for(var i=0;i<doorInfoFavoritesVal.length;i++){var doorInfoObj=doorInfoFavoritesVal[i];if(doorInfoObj){var doorKey=doorInfoObj.doorKey;if(dorKeyParam&&doorKey&&dorKeyParam==doorKey){var doorDetail=doorInfoObj.doorDetail;doorDetail&&(cityId=doorDetail.cityId,cityName=doorDetail.cityName);break}}}}cityId=null==cityId?gaodemap.cityId:cityId;var isZuCheValid,isGaodeAddrValid=checkIsInPoly(new AMap.LngLat(lng,lat));if(isGaodeAddrValid){var checkSendCarAddressRes=checkSendCarAddress(cityId,lng,lat);isZuCheValid=checkSendCarAddressRes.isValid}if(!isZuCheValid||!isGaodeAddrValid)return void zuche_maskplayer.notifyDialog("此位置已超出上门送取范围，请选择蓝色区域内地点，或选择到店取还前往附近门店！");zuche_maskplayer.closeGDMap("doorDiv",gaodemap.mapObj);var newText=name;$("#searchText").val(name),$("#searchTextShowVal").val(newText);var sentOrPickType=$("#sentOrPickType").val();"sentCar"==sentOrPickType?($("#backCarAddress").val(stringUtils.replaceBySpecialStr(name,22)),$("#sentAddress").val(stringUtils.replaceBySpecialStr(name,22)),$("#backCarAddress").attr("defaultValue",name),$("#sentAddress").attr("defaultValue",name),$("#sentCarLng").val(lng),$("#sentCarLat").val(lat),cityId&&cityName&&($("#fromCityId").val(cityId),$("input[link-input='fromCityId']").val(cityName)),cityId!=$("#toCityId").val()||1!=$("#returnType").val()&&1!=$("#picktype").val()?gaodemap.syncStoreInfo=!1:($("#returnCarAddress").val(stringUtils.replaceBySpecialStr(name,22)),$("#returnCarAddress").attr("defaultValue",name),$("#pickAddress").val(stringUtils.replaceBySpecialStr(name,22)),$("#pickAddress").attr("defaultValue",name),$("#pickCarLng").val(lng),$("#pickCarLat").val(lat),gaodemap.syncStoreInfo=!0),commonUtils.zuche_cookieUtil.add("sentAddressDetail",address+"|"+name,1),gaodemap.isSendstoreDiy=checkSendCarAddressRes.isDiy,gaodemap.syncStoreInfo&&(gaodemap.isPickstoreDiy=checkSendCarAddressRes.isDiy),gaodemap.addDiyTag()):"pickCar"==sentOrPickType&&($("#returnCarAddress").val(stringUtils.replaceBySpecialStr(name,22)),$("#pickAddress").val(stringUtils.replaceBySpecialStr(name,22)),$("#returnCarAddress").attr("defaultValue",name),$("#pickAddress").attr("defaultValue",name),$("#pickCarLng").val(lng),$("#pickCarLat").val(lat),cityId&&cityName&&($("#toCityId").val(cityId),$("#toCityName").val(cityName)),commonUtils.zuche_cookieUtil.add("pickAddressDetail",address+"|"+name,1),gaodemap.isPickstoreDiy=checkSendCarAddressRes.isDiy,gaodemap.addDiyTag())})};gaodemap.addDiyTag=function(){function addFromTag(){$sendDl.addClass("diy"),$sendBox.addClass("diy")}function addToTag(){$pickDl.addClass("diy"),$pickBox.addClass("diy")}function adjustHeadlist(){$headlist.addClass("diy")}function adjustRestChbox(){$sendBox.siblings(".ch_box:gt(0)").addClass("prevdiy")}function adjustTostore(){$pickDl.addClass("prevdiy")}function adjustRentTerm(){$rentTermDl.addClass("prevdiy")}function adjustTipPos(){var storePos=$("#toStoreName").offset(),parentPos=$(".ch_box").offset();if(0===storePos.left&&(storePos=$("#pickAddress").offset()),storePos&&parentPos){var left=storePos.left-parentPos.left+10+"px";$(".ch_box").find(".tip_diy").css({left:left})}}var $sendDl=$(".from_store"),$pickDl=$(".to_store"),$rentTermDl=$(".rent_term"),$sendBox=$(".ch_box_from"),$pickBox=$(".ch_box_to"),$headlist=$(".zc_headlist"),isTohome=$(".zc_index_dz").hasClass("bhnew"),isOrderControl=$(".dz_conbox").length>0,status=checkStoreStatus(),isFromDiy=status.isFromDiy,isToDiy=status.isToDiy;clearTags(),isTohome?(gaodemap.homeSend?gaodemap.isSendstoreDiy=!1:gaodemap.isSendstoreDiy=1==isFromDiy,gaodemap.homeReturn?gaodemap.isPickstoreDiy=!1:gaodemap.isPickstoreDiy=1==isToDiy,gaodemap.isSendstoreDiy&&(addFromTag(),adjustTostore()),gaodemap.isPickstoreDiy&&(addToTag(),adjustRentTerm())):(gaodemap.homeSend&&(isFromDiy=gaodemap.isSendstoreDiy),gaodemap.homeReturn&&(isToDiy=gaodemap.isPickstoreDiy),(isFromDiy||isToDiy)&&(isFromDiy&&(addFromTag(),isOrderControl&&adjustRestChbox()),isToDiy&&addToTag(),isOrderControl?(adjustTipPos(),adjustHeadlist()):adjustRentTerm()))},gaodemap.clearTags=clearTags,gaodemap.addDiyTag();var initBindEvent=function(){var keyupFlag=null;$(".btn-text").die().live({focus:function(){$("#search-part").show(),$("#collect-part").hide(),$(".down-icon").hide(),$("#collect").removeClass("down-on");var txt_value=$("#searchText").val(),defalutValue=$(this).attr("defalutValue");txt_value&&txt_value!=defalutValue?txt_value&&txt_value!=defalutValue&&$(this).val($("#searchText").val()):($(this).val(""),$("#searchText").val("")),$(".btn-search").addClass("btn-search-on"),$(".btn-text").addClass("btn-text-on"),$(".btn-delete").addClass("btn-delete-on")},blur:function(){var txt_value=$("#searchText").val(),defalutValue=$(this).attr("defalutValue");$(this).val()&&txt_value&&txt_value!=defalutValue||($(this).val(stringUtils.replaceBySpecialStr(defalutValue,27)),$("#searchText").val(defalutValue),$(".btn-search").removeClass("btn-search-on"),$(".btn-text").removeClass("btn-text-on"),$(".btn-delete").removeClass("btn-delete-on"))},keyup:function(){keyupFlag&&clearTimeout(keyupFlag);var txt_value=$(this).val();$("#searchText").val(txt_value),txt_value&&(keyupFlag=setTimeout(function(){doMapResearch(txt_value)},500))}}),$(".btn-delete,.white_close").click(function(){$("#searchText").val(""),$(".btn-text").val("").focus()}),$("#btclose").click(function(){zuche_maskplayer.closeGDMap("doorDiv",gaodemap.mapObj)})};$("#collect").click(function(){$(this).toggleClass("down-on");var downonFlag=$(this).hasClass("down-on");if(downonFlag){$("#search-part").hide(),$("#collect-part").show(),$(".down-icon").show();var doorInfoFavoritesVal=commonUtils.zuche_cookieUtil.getValue("doorInfoFavorites"),html='<div class="btn-null"></div><p class="null_text">您还没有使用过的取/送车地址，或自己设定的<br>常用地址。</p>';if($("#collect-part").addClass("no-scroll"),doorInfoFavoritesVal){doorInfoFavoritesVal=JSON.parse(doorInfoFavoritesVal);for(var poisFavoritesList=[],i=0;i<doorInfoFavoritesVal.length;i++){var doorInfoObj=doorInfoFavoritesVal[i];if(doorInfoObj){var lng=doorInfoObj.doorDetail.lng,lat=doorInfoObj.doorDetail.lat,lnglat=new AMap.LngLat(lng,lat),name=doorInfoObj.doorDetail.name,address=doorInfoObj.doorDetail.address;gaodemap.mapObj.setCenter(lnglat),addMapCenterMarker(lnglat),poisFavoritesList.push({name:name,location:gaodemap.mar.getPosition(),address:address})}}poisFavoritesList&&poisFavoritesList.length>0&&(html=$("#poisFavoritesTemplate").render({poisFavoritesList:eval(poisFavoritesList)}),$("#collect-part").removeClass("no-scroll"))}$("#collect-part").html(html),bindEvent()}else $("#search-part").show(),$("#collect-part").hide(),$(".down-icon").hide()}),gaodemap.getSendOrGetCarInfo=function(sentType,searchName){var sentOrPickType=$("#sentOrPickType").val(),carScope="送车",fromCityId=$("#fromCityId").val(),toCityId="";if("sentCar"==sentOrPickType?$("#doorTitleSpan").text("送车上门地址"):"pickCar"==sentOrPickType&&($("#doorTitleSpan").text("取车上门地址"),carScope="取车",toCityId=$("#toCityId").val()),sentType||(sentType=0),fromCityId){var dataParam={sendCarCityId:fromCityId,takeCarCityId:toCityId,sentOrPickType:sentOrPickType,sentType:sentType};$.ajax({url:"/sendOrGetCar/sendOrGetCarInfo.do",data:dataParam,type:"post",dataType:"json",success:function(data){if("0"==data.status){var re=data.re;if(re){var singleFreePromot=re.singleFreePromot,doubleFreePromot=re.doubleFreePromot,serviceScope=re.serviceScope,sendPricedes="";serviceScope&&(serviceScope.scopedes,sendPricedes=serviceScope.sendPricedes,"pickCar"==sentOrPickType)&&(sendPricedes=serviceScope.takePricedes);var htmlStr="";if(carScope&&sendPricedes){htmlStr="<b>"+carScope+'范围：</b>地图蓝色边界范围内，请提前4个工作小时下单，即可<span class="yellow">免费</span>尊享'+carScope+'上门服务。如距离取/还车时间不足4小时，可以选择<a id="toddqhMapTop" href="javascript:void(0)">到店取还</a>。<br>',singleFreePromot&&(htmlStr+=singleFreePromot),doubleFreePromot&&(htmlStr+=doubleFreePromot),$("#doorIntroP").html(htmlStr);var showText=carScope+"范围：地图蓝色边界范围内";$("#searchTextShowVal").attr("defalutValue",showText),searchName&&(showText=searchName);var newText=stringUtils.replaceBySpecialStr(showText,27);$("#searchText").val(showText),$("#searchTextShowVal").val(newText),$("#toddqhMapTop").click(function(){zuche_maskplayer.close(),toddqhurl()})}}}}})}else zuche_maskplayer.notifyDialog("请选择取车或还车城市！")};var getFindFenceList=function(takeCityId){var returnDate=null;return takeCityId=gaodemap.cityId,takeCityId&&$.ajax({url:"/sendOrGetCar/sendCarRangeFindFenceList.do",data:{takeCityId:takeCityId},type:"post",dataType:"json",cache:!1,async:!1,success:function(data){if("0"==data.status){var re=data.re;re&&(returnDate=re)}}}),returnDate},checkSendCarAddress=function(takeCityId,sendLng,sendLat){var isValid=!1;return takeCityId&&sendLng&&sendLat&&$.ajax({url:"/sendOrGetCar/sendCarRangeCheckPosition.do",data:{takeCityId:takeCityId,sendLng:sendLng,sendLat:sendLat},type:"post",dataType:"json",cache:!1,async:!1,success:function(data){if("0"==data.status){var re=data.re;re&&(isValid=re)}}}),{isValid:isValid,isDiy:!1}},initInfo=function(){$("#search-part").show(),$("#collect-part").hide(),$("#collect").removeClass("down-on"),$(".btn-search").removeClass("btn-search-on"),$(".btn-text").removeClass("btn-text-on"),$(".btn-delete").removeClass("btn-delete-on"),$("#search-part").html("")};gaodemap.init=function(){gaodemap.createMap(),initBindEvent(),bindEvent(),bindPlaceSearch()},gaodemap.initInfo=initInfo,gaodemap.refreshMapByLaglat=refreshMapByLaglat,module.exports=gaodemap}),define("public/common/szmasklayer",[],function(require,exports,module){zuche_maskplayer={show:function(popID,refresh,monitorId){var popObj=$("#"+popID),popURL=popObj.attr("mask-data"),query=popURL.split("?"),dim=query[1].split("&"),popWidth=dim[0].split("=")[1],method="close";refresh&&(method="closeRefresh"),monitorId||(monitorId="popup"),"0"==popObj.children(".maskclose").length&&popObj.prepend('<a href="javascript:zuche_maskplayer.'+method+"('"+popID+'\')" id="close_'+monitorId+'" class="close maskclose1">&nbsp;</a>'),popObj.addClass("popup_block_show"),popObj.fadeIn().css({width:Number(popWidth)});var msgWidth=popObj.width(),msgHeight=popObj.height(),bgWidth=zuche_maskplayer.myClientWidth(),bgHeight=zuche_maskplayer.myClientHeight(),bgTop=zuche_maskplayer.myScrollTop(),bgLeft=zuche_maskplayer.myScrollLeft(),top=bgTop+Math.round((bgHeight-msgHeight)/2),left=bgLeft+Math.round((bgWidth-msgWidth)/2);popObj.css({position:"absolute",top:top+"px",left:left+"px"}),$("body").append('<div id="fade" class="fade_'+popID+'" style="display:block;"></div>'),$("#fade").css({filter:"alpha(opacity=65)"}).fadeIn(),$("#dialogBtn").click(function(){zuche_maskplayer.close(popID)})},myScrollTop:function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},myScrollLeft:function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0},myClientWidth:function(){return document.documentElement.clientWidth||document.body.clientWidth||0},myClientHeight:function(){return document.documentElement.clientHeight||document.body.clientHeight||0},notifyDialog:function(msg,callback){if(msg){zuche_maskplayer.close(),$(".tempDialog").remove();var dialog=zuche_maskplayer.getDialogBody("notify",msg);$("body").append(dialog),zuche_maskplayer.show("notifyDialog"),"function"==typeof callback&&$(".tempDialog").find(".maskclose").click(function(){callback()})}},notifyDialogHertz:function(msg,callback){if(msg){zuche_maskplayer.close(),$(".tempDialog").remove();var dialog=zuche_maskplayer.getDialogBody("notify",msg);$("body").append(dialog),zuche_maskplayer.show("notifyDialog",!0),"function"==typeof callback&&$(".tempDialog").find(".maskclose").click(function(){callback()})}},notifyDialogBtn:function(msg,callback,btnName){if(msg){$(".tempDialog").remove();var dialog=zuche_maskplayer.getDialogBody("notify",msg);dialog=dialog.replace(/关闭/,btnName),$("body").append(dialog),zuche_maskplayer.show("notifyDialog"),"function"==typeof callback&&$(".tempDialog").find(".maskclose").click(function(){callback()})}},notifyDialogBtnNew:function(msg,callback,btnName){if(msg){zuche_maskplayer.close("notifyDialogBtnNew"),$(".tempDialog").remove();var dialogId="notifyDialogBtnNew",btnValue=btnName,dialog="<div  id='"+dialogId+"' class='tempDialog d_none popup_block' mask-data='#?w=350' style='z-index:1000000'><div class='orderDialog' style='width: 350px;min-height: 150px;'>";dialog+='<h1 class="f18h1 pc_masklayer_b ac">'+"温馨提示"+'</h1><p class="msg_p p10 ac f14 '+"fontBlue"+'" style="word-wrap: break-word;word-break: normal;">'+msg+'</p><p class="ac p10"><input id="dialogBtn" maskclose name="" type="button" value="'+btnValue+'" class="btn_bluewauto white f14w w80 maskclose"></p>',dialog+="</div></div>",$("body").append(dialog),zuche_maskplayer.show("notifyDialogBtnNew"),"function"==typeof callback&&$(".tempDialog").find(".maskclose").click(function(){callback()})}},optConfirm:function(msg,callback){if(msg){zuche_maskplayer.close(),$(".tempDialog").remove();var dialog=zuche_maskplayer.getDialogBody("confirm",msg);$("body").append(dialog),zuche_maskplayer.show("confirmDialog"),"function"==typeof callback&&$("#dialogBtn").click(function(){callback()})}},optConfirm2:function(msg,callback){if(msg){zuche_maskplayer.close(),$(".tempDialog").remove();var dialogId="confirmDialog",dialog="<div  id='"+dialogId+"' class='tempDialog d_none popup_block' mask-data='#?w=350'><div class='orderDialog' style='width: 350px;min-height: 150px;'>";dialog+='<h1 class="f18h1 pc_masklayer_b ac">'+"操作确认"+'</h1><p class="msg_p p10 ac f14 '+"fontRed"+'" style="word-wrap: break-word;word-break: normal;">'+msg+'</p><p class="ac p10"><input id="dialogBtn" maskclose name="" type="button" value="'+"确认"+'" class="btn_bluewauto white f14w w80 maskclose">&nbsp;&nbsp;<input id="closeBtn" maskclose name="" type="button" value="取消" class="btn_graywauto gray f14w w80 maskclose cancelBtn"></p>',dialog+="</div></div>",$("body").append(dialog),zuche_maskplayer.show(dialogId),$(".tempDialog").find("#dialogBtn").click(function(){zuche_maskplayer.close(dialogId),"function"==typeof callback&&callback()}),$(".tempDialog").find(".cancelBtn").click(function(){zuche_maskplayer.close(dialogId)})}},optConfirm3:function(msg,callback){if(msg){zuche_maskplayer.close(),$(".tempDialog").remove();var dialogId="confirmDialog",dialog="<div  id='"+dialogId+"' class='tempDialog d_none popup_block' mask-data='#?w=350'><div class='orderDialog' style='width: 350px;min-height: 150px;'>";dialog+='<h1 class="f18h1 pc_masklayer_b ac">'+"操作确认"+'</h1><p class="msg_p p10 ac f14 '+"fontRed"+'" style="word-wrap: break-word;word-break: normal;">'+msg+'</p><p class="ac p10"><input id="dialogBtn" maskclose name="" type="button" value="'+"重新绑定"+'" class="btn_bluewauto white f14w w80 maskclose">&nbsp;&nbsp;<input id="closeBtn" maskclose name="" type="button" value="取消" class="btn_graywauto gray f14w w80 maskclose cancelBtn"></p>',dialog+="</div></div>",$("body").append(dialog),zuche_maskplayer.show(dialogId),$(".tempDialog").find("#dialogBtn").click(function(){zuche_maskplayer.close(dialogId),"function"==typeof callback&&callback()}),$(".tempDialog").find(".cancelBtn").click(function(){zuche_maskplayer.close(dialogId)})}},optConfirm4:function(msg,callback){if(msg){zuche_maskplayer.close(),$(".tempDialog").remove();var dialogId="confirmDialog",dialog="<div  id='"+dialogId+"' class='tempDialog d_none popup_block' mask-data='#?w=350'><div class='orderDialog' style='width: 350px;min-height: 150px;'>";dialog+='<p class="msg_p p20 ac f16 " style="word-wrap: break-word;word-break: normal;padding-top:32px">'+msg+'</p><p class="ac p10"><input id="closeBtn" maskclose name="" type="button" value="取消" class="bgray f14w w80 maskclose cancelBtn" style="height:30px">&nbsp;&nbsp;<input id="dialogBtn" maskclose name="" type="button" value="'+"继续返回"+'" class="btn_bluewauto gray f14w w80 maskclose"></p>',dialog+="</div></div>",$("body").append(dialog),zuche_maskplayer.show(dialogId),$(".tempDialog").find("#dialogBtn").click(function(){zuche_maskplayer.close(dialogId),"function"==typeof callback&&callback()}),$(".tempDialog").find(".cancelBtn").click(function(){zuche_maskplayer.close(dialogId)})}},errorDialog:function(msg,callback){if(msg){zuche_maskplayer.close(),$(".tempDialog").remove();var dialog=zuche_maskplayer.getDialogBody("error",msg);$("body").append(dialog),zuche_maskplayer.show("errorDialog"),"function"==typeof callback&&$(".tempDialog").find(".maskclose").click(function(){callback()})}},progressDialog:function(msg,callback){$(".tempDialog").remove(),msg||(msg="请稍候..."),zuche_maskplayer.close();var dialog=zuche_maskplayer.getDialogBody("progress",msg);$("body").append(dialog),$("#progressDialog .msg_p").prepend("<img src='https://image.zuchecdn.com/newversion/common/loading.gif'/>"),zuche_maskplayer.show("progressDialog"),"function"==typeof callback&&$(".tempDialog").find(".maskclose").click(function(){callback()})},winxintipsDialog:function(msg,callback){$(".tempDialog").remove(),zuche_maskplayer.close(),msg||(msg='数据配置错误，请拔打 <span class="fontOrange bold">400-616-6666</span> 联系客服');var dialog=zuche_maskplayer.getDialogBody("winxintips",msg);$("body").append(dialog),zuche_maskplayer.show("winxintips"),"function"==typeof callback&&$(".tempDialog").find(".maskclose").click(function(){callback()})},confirmDialog:function(msg,confirmCallback,cancelCallback,monitorId,leftBtnName,rightBtnName){zuche_maskplayer.close(),$(".tempDialog").remove(),monitorId||(monitorId="confirmDialog"),leftBtnName||(leftBtnName="取消"),rightBtnName||(rightBtnName="确定");var dialog='<div id="confirmDialog" class="tempDialog popup_block" mask-data="#?w=350"><div class="orderDialog" style="width:350px;min-height:187px;padding-top:30px;"><h1 class="f18h1 pc_masklayer_b ac black">温馨提示</h1><p class="msg_p p10 ac f12 line_h20">'+msg+'</p><p class="ac p10"><input name="" type="button" value="'+leftBtnName+'" id="cancel_'+monitorId+'" class="btn_graywauto gray f14w w80 maskclose cancelBtn">&nbsp;&nbsp;<input name="" type="button" value="'+rightBtnName+'" id="confirm_'+monitorId+'" class="btn_bluewauto white f14w w80 maskclose confirmBtn"></p></div></div>';$("body").append(dialog),zuche_maskplayer.show("confirmDialog",!1,monitorId),$(".tempDialog").find(".confirmBtn").click(function(){zuche_maskplayer.close("confirmDialog"),"function"==typeof confirmCallback&&confirmCallback()}),$(".tempDialog").find(".cancelBtn").click(function(){zuche_maskplayer.close("confirmDialog"),"function"==typeof cancelCallback&&cancelCallback()})},confirmDialog1:function(msg,callback,monitorId){zuche_maskplayer.close(),$(".tempDialog").remove(),monitorId||(monitorId="confirmDialog");var dialog="<div  id='confirmDialog' class='tempDialog d_none popup_block' mask-data='#?w=350'><div class='orderDialog' style='width: 350px;min-height: 150px;'>"+'<h1 class="f18h1 pc_masklayer_b ac">温馨提示</h1><p class="msg_p p10 ac f14 fontBlue" style="word-wrap: break-word;word-break: normal;">'+msg+'</p><p class="ac p10"><input name="" type="button" id="confirm_'+monitorId+'" value="确定"class="btn_bluewauto white f14w w80 maskclose confirmBtn" ></p></div></div>';$("body").append(dialog),zuche_maskplayer.show("confirmDialog",!1,monitorId),"function"==typeof callback&&$(".tempDialog").find(".confirmBtn").click(function(){zuche_maskplayer.close("confirmDialog"),callback()})},getDialogBody:function(flag,msg){var msgColor="",title="温馨提示",dialogId="notifyDialog",btnValue="关闭";msgColor="fontBlue","error"==flag?(msgColor="fontRed",title="错误信息",dialogId="errorDialog"):"progress"==flag?dialogId="progressDialog":"winxintips"==flag?(dialogId="winxintips",msgColor=""):"confirm"==flag&&(dialogId="confirmDialog",title="操作确认",msgColor="fontRed",btnValue="确认");var dialog="<div  id='"+dialogId+"' class='tempDialog d_none popup_block' mask-data='#?w=350'><div class='orderDialog' style='width: 350px;min-height: 150px;'>";return dialog+='<h1 class="f18h1 pc_masklayer_b ac">'+title+'</h1><p class="msg_p p10 ac f14 '+msgColor+'" style="word-wrap: break-word;word-break: normal;">'+msg+'</p><p class="ac p10"><input id="dialogBtn" maskclose name="" type="button" value="'+btnValue+'" class="btn_bluewauto white f14w w80 maskclose"></p>',dialog+="</div></div>"},close:function(id){if(id){var layerId=".fade_"+id;$(layerId+", #"+id).hide(),$(layerId).remove()}else $("#fade , .popup_block_show").hide(),$("#fade").remove(),$(".popup_block_show").removeClass("popup_block_show")},closeGDMap:function(id,mapobj){if(id){var layerId=".fade_"+id;$(layerId+", .popup_block_show").hide(),$(layerId).remove()}else $("#fade , .popup_block_show").hide(),$("#fade").remove();$(".popup_block_show").removeClass("popup_block_show"),mapobj.destroy(),mapobj=null},closeRefresh:function(id){if(id){var layerId=".fade_"+id;$(layerId+", .popup_block_show").fadeOut(function(){$(layerId).remove()})}else $("#fade , .popup_block_show").fadeOut(function(){$("#fade").remove()});$(".popup_block_show").removeClass("popup_block_show"),window.location.reload()},closeimediate:function(id){if(id){var layerId=".fade_"+id+",.popup_block_show";$(layerId).remove()}else $("#fade").remove()}},$(".poplight[lang^=#]").click(function(){var popID=$(this).attr("data-reveal-id"),popURL=$(this).attr("lang"),query=popURL.split("?"),dim=query[1].split("&"),popWidth=dim[0].split("=")[1];$("#"+popID).fadeIn().css({width:Number(popWidth)}).prepend('<a href="#" class="close _maskclose">&nbsp;</a>');var popMargTop=($("#"+popID).height()+80)/2,popMargLeft=($("#"+popID).width()+80)/2;return $("#"+popID).css({"margin-top":-popMargTop,"margin-left":-popMargLeft}),$("body").append('<div id="fade"></div>'),$("#fade").css({filter:"alpha(opacity=80)"}).fadeIn(),!1}),$(".poplight[data-titile^=#]").click(function(){var popID=$(this).attr("data-reveal-id"),popURL=$(this).attr("data-titile"),query=popURL.split("?"),dim=query[1].split("&"),popWidth=dim[0].split("=")[1];$("#"+popID).fadeIn().css({width:Number(popWidth)}).prepend('<a href="#" class="close _maskclose">&nbsp;</a>');var popMargTop=($("#"+popID).height()+80)/2,popMargLeft=($("#"+popID).width()+80)/2;return $("#"+popID).css({"margin-top":-popMargTop,"margin-left":-popMargLeft}),$("body").append('<div id="fade"></div>'),$("#fade").css({filter:"alpha(opacity=80)"}).fadeIn(),!1}),$("a._maskclose").live("click",function(){return $("#fade , .popup_block").fadeOut(function(){$("#fade, a._maskclose").remove()}),!1}),module.exports=zuche_maskplayer}),define("public/common/common_utils",[],function(require,exports,module){commonUtils={},commonUtils.checkIEVersion=function(version){return!!document.all&&[/MSIE (\d{1,2})\.0/i.exec(navigator.userAgent)][0][1]==version},commonUtils.zuche_cookieUtil={add:function(key,value,expiresHour,domain){var expires=new Date;expires.setTime(expires.getTime()+3600*expiresHour*1e3),domain||(domain=".zuche.com"),document.cookie=key+"="+escape(value)+"; expires="+(expiresHour?";expires="+expires.toGMTString():"")+";path=/; domain="+domain},getValue:function(key){var cookies=document.cookie;if(cookies.length>0){var cookieArray=cookies.split(";");if(cookieArray.length>0)for(var i=0;i<cookieArray.length;i++){var cookie=cookieArray[i];if(cookie=unescape(cookie),cookie.indexOf(key)>-1){var value=cookie.substring(cookie.indexOf("=")+1,cookie.length);return value}}}return null},deleteCookie:function(key,domain){domain||(domain=".zuche.com"),key&&(document.cookie=key+"=''; expires="+new Date(0).toGMTString()+";path=/; domain="+domain)}},commonUtils.zuche_securityUtils={rsa_encode:function(str){setMaxDigits(131);var rsak="805d6d437bdcb338bf346906bcc1baad8661124ffe612bd5fb0778ed513ee0cf857f47642df5aee2187b0ee061edfd97a0a53e7aebbf4bc7be998d461d58d027a257401449bf7e06734319a4a2424251b52d78aedb97d2a8e13f5447fcf84ba3e27b8f2743912ffe21fa74e2a77f95f961331464291788db1fb4250c488e7551",key=new RSAKeyPair("10001","",rsak);return encryptedString(key,str)}},commonUtils.zuche_storeUtils=function(){var storeCache=[],getStoreFromCache=function(id){var storeInfo="";return $.each(storeCache,function(i,store){if(store.id==id)return storeInfo=store.data,!1}),storeInfo},getStoreByTypeFromCache=function(cityId,serviceType){var storeInfo="";return $.each(storeCache,function(i,store){if(store.data.cityCode==cityId&&store.data.serviceType==serviceType)return storeInfo=store.data,!1}),storeInfo},putStore2Cache=function(store){getStoreFromCache(store.id)||storeCache.push(store)};return{getStore:function(id,callback){var storeInfo=getStoreFromCache(id);return storeInfo||$.ajax({url:"/department/getDepartmentJson/getStoreInfo.do",type:"post",data:{storeId:id},dataType:"json",async:!1,success:function(data){if(data){var store={};store.id=id,store.data=data,storeInfo=store.data,putStore2Cache(store),"function"==typeof callback&&callback()}}}),storeInfo},getSentCarStore:function(cityId,serviceType,callback){var storeInfo=getStoreByTypeFromCache(cityId,serviceType);return storeInfo||$.ajax({url:"/department/getDepartmentJson/getStoreByServiceType.do",type:"post",data:{cityId:cityId,serviceType:serviceType},dataType:"json",async:!1,success:function(data){if(data){var store={};store.id=data.code,store.data=data,storeInfo=store.data,putStore2Cache(store),"function"==typeof callback&&callback()}}}),storeInfo}}}(),commonUtils.getUrlParam=function(key){var url=window.location.search;if(!(url=url.split("?")[1]))return null;var value=null,params=url.split("&");return $.each(params,function(i,param){var kv=param.split("=");if(kv[0]==key)return value=decodeURIComponent(kv[1]),!1}),value},module.exports=commonUtils}),define("public/utils/stringutils",[],function(require,exports,module){var stringUtils={},leftTrim=function(strValue){if(!strValue)return"";var re=/^\s*/;return strValue.replace(re,"")},rightTrim=function(strValue){if(!strValue)return"";var re=/\s*$/;return strValue.replace(re,"")};stringUtils.trim=function(str){var strReturn;return strReturn=leftTrim(str),strReturn=rightTrim(strReturn)},stringUtils.trim2=function(str){var ws="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=new RegExp("^"+ws+ws+"*"),trimEndRegexp=new RegExp(ws+ws+"*$");if(void 0===str||null===str)throw new TypeError("can't convert "+str+" to object");return String(str).replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}return str.trim()},stringUtils.getBytesLength=function(str){return str.replace(/[^\x00-\xff]/g,"xx").length},stringUtils.replaceBySpecialStr=function(orginStr,retainLen,specialStr){if(stringUtils.getBytesLength(orginStr)>retainLen){specialStr||(specialStr="......");for(var i=0,z=0;z<retainLen;z++)if(orginStr.charCodeAt(z)>255?i+=2:i+=1,i>=retainLen){orginStr=orginStr.slice(0,z+1)+specialStr;break}}return orginStr},module.exports=stringUtils}),define("public/lib/jquery/jquery.deptport",[],function(require,exports,module){!function($){var gaodemap=require("som/ref/index/door");$.fn.extend({deptPort:function(opt){function checkStoreTags(store){var isDiy=store.isDiy,is24h="00:00-24:00"==store.workTime,isAirport=0==store.serviceType,isTrainStation=11==store.serviceType,isServicePoint=400==store.type,storeTypeMap={0:"airport",11:"train_station",400:"service_point"},storeTypeClass=isAirport&&storeTypeMap[0]||isTrainStation&&storeTypeMap[11]||isServicePoint&&storeTypeMap[400]||"",isChain=store.isChain||"292"==store.cityCode;return(isDiy?'<span class="store_diy">仅自助</span>':"")+(is24h?'<span class="store_tag_icon store_24h"></span>':"")+(storeTypeClass?'<span class="store_tag_icon store_type '+storeTypeClass+'"></span>':"")+(isChain?'<span class="store_tag_icon store_chain"></span>':"")}function getCityId(obj,cityDivId){return cityDivId?$("#"+cityDivId).val():$(obj).prev().val()}function buildDefaultDeptHtml(data){if($(opt.suggdiv).html(""),data&&data.PT&&data.PT.length>0||data.AA&&data.AA.length>0||data.BD&&data.BD.length>0||data.SW&&data.SW.length>0){var html='<ol class="clearfix xbox"><li class="graybor"><div class="iptSeup areaup"></div></li><li class="bluebor">&nbsp;</li></ol><a href="javascript:void(0)" class="close">关闭</a><div class="areainfo"><div class="wbox_bd"><div class="bg_white gray_6B0B3B2">您可以输入关键字/词，用键盘上的“↑↓←→”选择</div>';data.PT&&data.PT.length>0&&data.PT[0].deps.length>0&&(html+='<dl class="clearfix PT"><dt>机场火车站</dt>',$.each(data.PT[0].deps,function(index,value){value.cityCode,html+='<dd><a name="jsdep" depType="'+value.type+'" data-isdiy="'+(v.isDiy?1:0)+'" code="'+value.code+'" deptName="'+value.name+'"  isChain="'+value.isChain+'">'+value.name+checkStoreTags(value)+"</a>";var addhtml='<div class="areaMD d_none"  style="display:none;"><div class="shopinfo" style="margin-top:0px;"><div>';value.addressEqFlag||0===value.addressEqFlag?0===value.addressEqFlag?addhtml+='<span class="wtitle">地　　址：</span><span class="w235">'+value.address+"</span>":3===value.addressEqFlag?(addhtml+='<span class="wtitle" style="width:auto;">门店地址(取车地址)：</span><span>'+value.address+"</span>",addhtml+='<span class="clear wtitle">还车地址：</span><span class="w235">'+value.return_address+"</span>"):4===value.addressEqFlag?(addhtml+='<span class="wtitle" style="width:auto;">门店地址(还车地址)：</span><span>'+value.address+"</span>",value.airportPickupAddress&&(1==value.isPickupAirport&&0==value.serviceType?addhtml+='<span class="clear wtitlesj">接送机位置：</span><span class="w220" style="color: #848484;">'+value.airportPickupAddress+"</span>":1!=value.isPickupAirport||10!=value.serviceType&&11!=value.serviceType?addhtml+='<span class="clear wtitle">取车地址：</span><span class="w235">'+value.airportPickupAddress+"</span>":addhtml+='<span class="clear wtitle">接站位置：</span><span class="w235">'+value.airportPickupAddress+"</span>")):(addhtml+='<span class="wtitle">门店地址：</span><span class="w235">'+value.address+"</span>",value.airportPickupAddress&&(1==value.isPickupAirport&&0==value.serviceType?addhtml+='<span class="wtitlesj">接送机位置：</span><span class="w220" style="color: #848484;">'+value.airportPickupAddress+"</span>":1!=value.isPickupAirport||10!=value.serviceType&&11!=value.serviceType?addhtml+='<span class="wtitle">取车地址：</span><span class="w235">'+value.airportPickupAddress+"</span>":addhtml+='<span class="wtitle">接站位置：</span><span class="w235">'+value.airportPickupAddress+"</span>"),value.return_address&&(addhtml+='<span class="wtitle">还车地址：</span><span class="w235">'+value.return_address+"</span>")):(addhtml+='<span class="wtitle">地　　址：</span><span class="w235">'+value.address+"</span>",value.airportPickupAddress&&value.isPickupAirport&&1==value.isPickupAirport&&(0==value.serviceType?addhtml+='<span class="wtitlesj">接送机地址：</span><span class="w220">'+value.airportPickupAddress+"</span>":10==value.serviceType&&(addhtml+='<span class="wtitle">接站地址：</span><span class="w235">'+value.airportPickupAddress+"</span>"))),addhtml+='<span class="clear wtitle">营业时间：</span><span class="w235">'+value.workTime+"</span>","1"==value.isChain&&(addhtml+='<br><span class="w235"><font style="color:#ed5565;">加盟店暂不接受异地/异店还车；暂不提供上门服务。</font></span>'),html+=addhtml+"</div></div></div>",html+="</dd>"}),html+="</dl>"),data.AA&&data.AA.length&&(html+=buildSuggestHtml("所有门店",data.AA)),data.BD&&data.BD.length>0&&(html+=buildSuggestHtml("热门商圈",data.BD)),data.SW&&data.SW.length>0&&(html+=buildSuggestHtml("地铁线",data.SW));var isChain;data.AA&&data.AA.length&&(isChain=data.AA[0].deps[0].isChain);if(data.AA&&data.AA.length){var cityCode=data.AA[0].deps[0].cityCode,startDate=new Date(2016,3,15,0,0,0),endDate=new Date(2016,4,31,23,59,59),nowDate=new Date;(116==cityCode||19==cityCode)&&startDate<=nowDate&&endDate>=nowDate&&!0}return html+=0==isChain?'</div></div><div class="gray safetychildrenseat-sm">部分城市指定区域，免费上门送取车！</div>':"</div></div>"}return""}function getNoRepeatDept(_data){var dept_threshold_count=4,dept_count=0,dept={};$.each(_data,function(index,value){$.each(value.deps,function(idx,v){var key="'"+v.code+"'";dept[key]||(dept[key]=v)})});var returnDept=new Array;for(var k in dept)dept_count+=1,returnDept.push(dept[k]);if(dept_threshold_count>=dept_count)return returnDept}function buildSuggestHtml(tag,_data){if(!_data)return"";try{var _html='<dl class="areainfo_address"><dt>'+tag+"</dt>",dept=getNoRepeatDept(_data);$.each(_data,function(index,value){var depts=value.deps,cls="areaMD d_none",style="";_html+="<dd>",dept?(depts=dept,cls="areaMD",style='style="display: block; left: 0px; top: 69px;"'):_html+="<a>"+value.name+"</a>",_html+='<div class="'+cls+'" '+style+' ><ul class="clearfix">';var scdCount=0,depCount=0;if($.each(depts,function(idx,v){if(300==v.type){depCount++;var thisclass="";0==idx&&(thisclass="areaMDcur"),v.isChain||v.cityCode;var headHtmlInfo='<li name="jsdep"';1e3==v.flag&&(headHtmlInfo='<li class="gray" name="jsdep"');var isMerge=0;v.isMergeDept&&(isMerge=v.isMergeDept),_html+=headHtmlInfo+' data-isdiy="'+(v.isDiy?1:0)+'" depType="'+v.type+'" code="'+v.code+'" isMergeDept="'+isMerge+'" isChain="'+v.isChain+'" idx="'+idx+'"  deptName="'+v.name+'" class="'+thisclass+'" ><a>'+v.name+checkStoreTags(v)+"</a></li>"}else scdCount++}),_html+="</ul>",scdCount>0&&(depCount>0&&(_html+="<div class='dotline'></div>"),_html+="<p class='scd-txt'>送车点</p><ul class='clearfix'>",$.each(depts,function(idx,v){if(400==v.type){var thisclass="";0==idx&&(thisclass="areaMDcur");var headHtmlInfo='<li name="jsdep"';1e3==v.flag&&(headHtmlInfo='<li class="gray" name="jsdep"');var isMerge=0;v.isMergeDept&&(isMerge=v.isMergeDept),_html+=headHtmlInfo+' depType="'+v.type+'" code="'+v.code+'" isMergeDept="'+isMerge+'" isChain="'+v.isChain+'" idx="'+idx+'" data-isdiy="'+(v.isDiy?1:0)+'"  deptName="'+v.name+'" class="'+thisclass+'" ><a>'+v.name+checkStoreTags(v)+"</a></li>"}}),_html+="</ul>"),_html+='<div class="shopinfo">',$.each(depts,function(idx,v){_html+='<div idx="'+idx+'"'+(0==idx?'style="display:inline"':'style="display:none"')+">",v.addressEqFlag||0===value.addressEqFlag?0===v.addressEqFlag?_html+='<span class="wtitle">地　　址：</span><span class="w235">'+v.address+"</span>":3===v.addressEqFlag?(_html+='<span class="wtitle" style="width:auto">门店地址(取车地址)：'+v.address+"</span>",_html+='<span class="clear wtitle">还车地址：</span><span class="w235">'+v.return_address+"</span>"):4===v.addressEqFlag?(_html+='<span class="wtitle" style="width:auto">门店地址(还车地址)：'+v.address+"</span>",v.airportPickupAddress&&(1==v.isPickupAirport&&0==v.serviceType?_html+='<span class="clear wtitlesj">接送机位置：</span><span class="w220" style="color: #848484;">'+v.airportPickupAddress+"</span>":1!=v.isPickupAirport||10!=v.serviceType&&11!=v.serviceType?_html+='<span class="clear wtitle">取车地址：</span><span class="w235">'+v.airportPickupAddress+"</span>":_html+='<span class="clear wtitle">接站位置：</span><span class="w235">'+v.airportPickupAddress+"</span>")):(_html+='<span class="wtitle">门店地址：</span><span class="w235">'+v.address+"</span>",v.airportPickupAddress&&(1==v.isPickupAirport&&0==v.serviceType?_html+='<span class="wtitlesj">接送机位置：</span><span class="w220" style="color: #848484;">'+v.airportPickupAddress+"</span>":1!=v.isPickupAirport||10!=v.serviceType&&11!=v.serviceType?_html+='<span class="wtitle">取车地址：</span><span class="w235">'+v.airportPickupAddress+"</span>":_html+='<span class="wtitle">接站位置：</span><span class="w235">'+v.airportPickupAddress+"</span>"),v.return_address&&(_html+='<span class="wtitle">还车地址：</span><span class="w235">'+v.return_address+"</span>")):(_html+='<span class="wtitle">地　　址：</span><span class="w235">'+v.address+"</span>",v.airportPickupAddress&&v.isPickupAirport&&1==v.isPickupAirport&&(0==v.serviceType?_html+='<span class="wtitlesj">接送机地址：</span><span class="w220">'+v.airportPickupAddress+"</span>":10==v.serviceType&&(_html+='<span class="wtitle">接站地址：</span><span class="w235">'+v.airportPickupAddress+"</span>"))),_html+='<span class="clear wtitle">营业时间：</span><span class="w235">'+v.workTime+"</span>",v.telephone?_html+='<span class="clear wtitle">门店电话：</span><span class="w235">'+v.telephone+"</span>":v.mobile&&(_html+='<span class="clear wtitle">门店电话：</span><span class="w235">'+v.mobile+"</span>"),"1"==v.isChain&&(_html+='<br><span class="w235"><font style="color:#ed5565;">加盟店暂不接受异地/异店还车；暂不提供上门服务。</font></span>'),_html+="</div>"}),_html+="</div>",_html+="</div>",_html+="</dd>",dept)return!1}),_html+='<div class="clear"></div></dl>'}catch(e){return""}return _html}function bindSelectEvent(store){$(".areainfo_address dd, .PT dd").each(function(i){$(this).hover(function(){$selectedDD=$(this),selectedTimeout=setTimeout(function(){var $pleft=$selectedDD.parents("div.areainfo"),left=null,tops=null;$pleft.position()&&(left=$pleft.position().left,tops=$pleft.position().top);var inpth=($selectedDD.find("div.areaMD").outerHeight(),$selectedDD.parents("div.areainfo").outerHeight());$selectedDD.outerWidth();$(".areainfo_address dd, .PT dd").find("a").removeClass("areainfocur"),$selectedDD.find("a").first().addClass("areainfocur");var area=$selectedDD.find("div.areaMD");$("div.areaMD").hide(),$(area).show().css({left:left,top:tops+inpth})},250)},function(){clearTimeout(selectedTimeout)})}),$(".areainfo_address .areaMD li").hover(function(){if(!$(this).hasClass("areaMDcur")){$(this).siblings().removeClass("areaMDcur"),$(this).parent("ul").siblings("ul").children("li").removeClass("areaMDcur"),$(this).hasClass("gray")||$(this).addClass("areaMDcur");var idx=$(this).attr("idx"),obj=$(this).parent().siblings(".shopinfo").children('[idx="'+idx+'"]');$(obj).siblings().css("display","none"),$(obj).css("display","inline")}},function(){}),$(store).siblings(opt.suggdiv).find(".close").click(function(){closeDepSelection(),$(opt).removeClass("iptSeupcur")}),$(store).siblings(opt.suggdiv).find('[name="jsdep"]').mousedown(function(){if(!$(this).hasClass("gray")){var code=$(this).attr("code"),isMerge=$(this).attr("ismergedept"),depname=$(this).attr("deptName"),depType=$(this).attr("depType"),index=depname.toLowerCase().indexOf("<span");$("#fromStoreType").val(depType),$("#toStoreType").val(depType),-1!=index&&(depname=depname.substring(0,index));var worktime=$(this).attr("worktime"),isChain=$(this).attr("isChain");if($(store).val(depname).addClass("bluewords"),$(store).removeClass("iptSeupcur"),$(store).next().val(code),$(store).next().next().val(isMerge),1==isMerge&&$(store).next().next().next().val($(store).prev().val()),$(store).attr("worktime",worktime),$(store).attr("isChain",isChain),$(store).blur(),"function"==typeof opt.onclick&&opt.onclick(),closeDepSelection(),opt.isChangeable){var $tar=$(this),isStoreDiy=$tar.attr("data-isdiy");$currentSelectStore.attr("data-isdiy",isStoreDiy),gaodemap.syncStoreInfo&&$("#toStoreName").attr("data-isdiy",isStoreDiy),gaodemap.addDiyTag()}}})}function closeDepSelection(){$(opt.suggdiv).html("")}var defaultData,defaultCityId,defaultTime,$currentSelectStore,suggestHtml='<div id="city_down_tips" class="city_down_tips"><div class="keydivh3"><p></p></div><div class="a_top_title"><div id="a_error_info" style="white-space:nowrap;"></div><span id="dep_tip_info"><font color="red">输入汉字，用↑↓← →选择</font></span></div><ul id="city_tips_info"></ul><div id="city_b_pager"></div></div>',SUGGEST_HTML=$(suggestHtml);return this.each(function(){var $this=$(this),$thisaa=$(this).find("a"),linkinput="#"+$this.attr("link-input"),showCityByArea=function(){$this.select(),$(SUGGEST_HTML).remove();var cityId=getCityId($this,opt.cityDivId),time="";time="fromStoreName"==$this.context.id?$("#fromDate").val()+" "+$("#fromHourMinute").val():$("#toDate").val()+" "+$("#toHourMinute").val();var left=$this.position().left;opt.leftoffset&&(left-=opt.leftoffset);var tops=$this.position().top;if(cityId)if(defaultCityId&&defaultData&&defaultCityId==cityId&&defaultTime&&defaultTime==time){var html=buildDefaultDeptHtml(defaultData);html&&($this.addClass("iptSeupcur"),$this.siblings(opt.suggdiv).html(html).show().css({left:left,top:tops}),bindSelectEvent($this))}else{var url=carwsomURL+"/api/dept/suggest/default.do?cityid="+cityId+"&time="+time,fromYear=$("#fromYear").val();fromYear&&(url+="&fromYear="+fromYear);var ishidechainstore=$("#ishidechainstore").val();ishidechainstore&&(url+="&ishidechainstore="+ishidechainstore),$.ajax({url:url,type:"get",dataType:"jsonp",error:function(){},success:function(data){defaultCityId=cityId,defaultData=data,defaultTime=time;var html=buildDefaultDeptHtml(data);html&&($this.addClass("iptSeupcur"),$this.siblings(opt.suggdiv).html(html).show().css({left:left,top:tops}),bindSelectEvent($this))}})}else $this.prev().prev().addClass("redbd redwords")};$this.bind("click",function(){showCityByArea(),$(".popup_pane").remove(),$(".paircitySelection").removeClass("iptSeupcur"),$currentSelectStore=$this});var a_page=1,a_totalPage=1,count=0;pagesize=8;var searchTimeout;$this.bind("keyup",function(e){function prev_(){count=0,a_page=a_page>1?a_page-1:a_totalPage,$("#city_tips_info li").removeClass("cur").hide(),$("li[t_id="+a_page+"]").show().removeClass("cur").eq(count).addClass("cur"),$("#city_b_pager").text(a_page+"/"+a_totalPage)}function next_(){count=0,a_page=a_page<a_totalPage?a_page+1:1,$("#city_tips_info li").removeClass("cur").hide(),$("li[t_id="+a_page+"]").show().removeClass("cur").eq(count).addClass("cur"),$("#city_b_pager").text(a_page+"/"+a_totalPage)}function up_(){count--,$("#city_tips_info li").hide(),$("li[t_id="+a_page+"]").show(),count>=0?$("li[t_id="+a_page+"]").removeClass("cur").eq(count).addClass("cur"):(count=$("li[t_id="+a_page+"]").length-1,$("li[t_id="+a_page+"]").removeClass("cur").eq(count).addClass("cur"))}function down_(){count++;var max_l=$("li[t_id="+a_page+"]").length-1;count>max_l&&(count=0),$("li[t_id="+a_page+"]").removeClass("cur").eq(count).addClass("cur")}function buildAdvancedSuggest(obj){count=0,a_page=1;var cityId=getCityId(obj,opt.cityDivId),query=$.trim($this.val().toUpperCase()),time="";if(time="fromStoreName"==$this.context.id?$("#fromDate").val()+" "+$("#fromHourMinute").val():$("#toDate").val()+" "+$("#toHourMinute").val(),""!=query){var encodeQuery=encodeURIComponent(encodeURIComponent(query)),arr=[],n=1,fromYear=$("#fromYear").val(),ishidechainstore=$("#ishidechainstore").val(),url=carwsomURL+"/api/dept/suggest/advanced.do";ishidechainstore&&(url+="?ishidechainstore="+ishidechainstore),$.ajax({url:url,type:"get",dataType:"jsonp",data:{cityid:cityId,q:encodeQuery,time:time,fromYear:fromYear},cache:!1,error:function(){},success:function(data){if(data){$.each(data.result,function(index,value){if("292"==value.cityCode?"show":"",2!=value.serviceType){var t_id=Math.ceil(n/pagesize);n++;var depname=value.name;1==value.searchresult&&(depname=depname.replace(query,'<font color="#ff6600">'+query+"</font>"));var extrainfo=checkStoreTags(value),headHtmlInfo="<li ";1e3==value.flag&&(headHtmlInfo='<li class="gray" ');var isMerge=0;value.isMergeDept&&(isMerge=value.isMergeDept),arr.push(headHtmlInfo+" data-isdiy="+(value.isDiy?1:0)+" t_id="+t_id+' depType="'+value.type+'" code="'+value.code+'" isMergeDept="'+isMerge+'" isChain="'+value.isChain+'"><div class="f-left">'+depname+"</div>"+extrainfo+'<div class="f-right">'+(value.distance?value.distance+'<font style="font-family: Tahoma">KM</font>':"")+"</div></li>")}});var l=arr.length;if(a_totalPage=l%pagesize==0?l/pagesize:Math.floor(l/pagesize)+1,l>pagesize?($("#city_tips_info").find("li").remove().end().append(arr.join("")),$("li[t_id="+a_page+"]").eq(count).addClass("cur"),$("#city_b_pager").text(a_page+"/"+a_totalPage),$("#city_b_pager").show(),$("#city_error_info").hide()):l>0&&($("#city_tips_info").find("li").remove().end().append(arr.join("")),$("li[t_id="+a_page+"]").eq(count).addClass("cur"),$("#city_b_pager,#city_error_info").hide()),$("#city_tips_info li").mousedown(function(e){if(!$(this).hasClass("gray")){e.stopPropagation;var dept=$(this).find(".f-left").text(),deptId=$(this).attr("code"),isChain=$(this).attr("isChain"),isMerge=$(this).attr("ismergedept"),isDiy=$(this).attr("data-isdiy");$(linkinput).val(deptId),$(obj).next().next().val(isMerge),1==isMerge&&$(obj).next().next().next().val($(obj).prev().val()),$(obj).val(dept),$(obj).blur(),$(obj).attr({isChain:isChain,"data-isdiy":isDiy}),"function"==typeof opt.onclick&&opt.onclick(),$("#city_down_tips").hide(),gaodemap.addDiyTag()}}),"N"==data.find&&0!=query.length)$(".a_top_title").css({background:"#fff"}),$("#a_error_info").html("很抱歉，没有搜到对应门店").show();else{var queryType=data.queryType;"position"==queryType?$("#dep_tip_info").html('<font color="#b9b9b9">地点在“</font><font color="#ff6600">'+query+'</font><font color="#b9b9b9">”附近的门店</font>'):"district"==queryType?$("#dep_tip_info").html('<font color="#b9b9b9">查找到“</font><font color="#ff6600">'+query+'</font><font color="#b9b9b9">”附近的门店</font>'):"name"==queryType?$("#dep_tip_info").html('<font color="#b9b9b9">名称含“</font><font color="#ff6600">'+query+'</font><font color="#b9b9b9">”的门店</font>'):"nameaddress"==queryType?$("#dep_tip_info").html('<font color="#b9b9b9">名称/地址含“</font><font color="#ff6600">'+query+'</font><font color="#b9b9b9">”的门店</font>'):"address"==queryType&&$("#dep_tip_info").html('<font color="#b9b9b9">地址含“</font><font color="#ff6600">'+query+'</font><font color="#b9b9b9">”的门店</font>'),$("#a_error_info").html("").hide()}}}})}}var code=e.keyCode,id=$this.attr("id"),isFrom="fromStoreName"==id,isTo="toStoreName"==id,clearType=isFrom&&1||isTo&&2||3;if(9!=code)if(37==code)a_totalPage>1&&a_page>1&&prev_();else if(38==code)up_();else if(39==code)1!=a_totalPage&&next_();else if(40==code)down_();else if(13==code){var licur=$("#city_tips_info li.cur"),text=$(licur).find(".f-left").text(),deptcode=$(licur).attr("code"),ismergedept=($(licur).attr("worktime"),$(licur).attr("ismergedept"));if(""!=text){$this.val(text).removeClass("citySU redwords").addClass("citySD bluewords"),$this.blur(),a_page=1,count=1,$(linkinput).val(deptcode),$(linkinput).next().val(ismergedept),1==ismergedept&&$(linkinput).next().next().val($(linkinput).prev().prev().val());var isChain=$(licur).attr("isChain");$this.attr("isChain",isChain),"function"==typeof opt.onclick&&opt.onclick(),$("#city_down_tips").hide()}else{$this.siblings(opt.suggdiv).html(""),$("#city_down_tips").length<=0&&($("#city_down_tips").remove(),$("body").append(suggestHtml),gaodemap.clearTags(clearType));var tops=$this.offset().top,left=$this.offset().left,h=tops+$this.outerHeight(),w=$this.outerWidth();$("#city_down_tips").show().css({left:left,top:h}),$("#city_down_tips").css({"min-width":w-2}),w>160&&$(".a_top_title").css({width:w-12}),$(".keydivh3, .keydivh3 p").css({width:w-2}),clearTimeout(searchTimeout),searchTimeout=setTimeout(function(){buildAdvancedSuggest($this)},300)}}else{$this.siblings(opt.suggdiv).html(""),$("#city_down_tips").length<=0&&($("#city_down_tips").remove(),$("body").append(suggestHtml),gaodemap.clearTags(clearType));var tops=$this.offset().top,left=$this.offset().left,h=tops+$this.outerHeight(),w=$this.outerWidth();$("#city_down_tips").show().css({left:left,top:h}),$("#city_down_tips").css({"min-width":w-2}),w>160&&$(".a_top_title").css({width:w-12}),$(".keydivh3, .keydivh3 p").css({width:w-2}),clearTimeout(searchTimeout),searchTimeout=setTimeout(function(){buildAdvancedSuggest($this)},300)}}),$thisaa.bind("blur",function(){$("#city_down_tips").hide(),$this.siblings(opt.suggdiv).html("")}),$(document).bind("click",function(e){$this.attr("t_popup","0");var btn_flag=$(e.target).attr("t_popup"),div_flag=$(e.target).closest(".areaSelection").hasClass("areaSelection");"0"==btn_flag||div_flag||($(".areaSelection ").hide(),$this.removeClass("iptSeupcur"))})});var selectedTimeout,$selectedDD}})}(jQuery)});